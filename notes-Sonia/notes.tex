\documentclass{article}

\title{Proposal: Decomposing labelled proof theory for intuitionistic modal logic}
\author{Sonia Marin}


\newcommand{\todo}[1]{\textcolor{red}{TODO: #1}}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\blue}[1]{{\color{blue}{#1}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Packages
\usepackage{geometry}
\geometry{vmargin=3.2cm,hmargin=3.5cm}%
\usepackage{rotating}

\usepackage{amsmath} % for improving the structure and printed output of documents containing mathematical formulas

\usepackage{amssymb} % for mathematical symbols and fonts
\usepackage{bm} % command \bm makes its ar­gu­ment bold, better than \boldsymbol{}
\usepackage{colonequals} % symbols := and ::=
\usepackage{cmll}  % Linear Logic symbols
\usepackage{wasysym} % for smiley 

\usepackage[matrix,arrow]{xy}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}%[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{question}[theorem]{Question}
\newtheorem{conjecture}[theorem]{Conjecture}
\renewcommand\qedsymbol{$\smiley$}

\usepackage{graphicx} % for graphics, and commands like \scalebox{h-scale}{text} in particular

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Proof package
\usepackage[noxy]{virginialake}
\vlnosmallleftlabels
\vlnostructuressyntax
%
\newcommand{\vlhtr}[2]{\vlpd{#1}{}{#2}}
%
\newcommand{\vlderivationauxnc}[1]{#1{\box\derboxone}\vlderivationterm}
\newcommand{\vlderivationnc}{\vlderivationinit\vlderivationauxnc}
%
%
\makeatletter
\newbox\@conclbox
\newdimen\@conclheight
%
\newcommand\vlderibase[4]{{%
		\setbox\@conclbox=\hbox{$#3$}\relax%
		\@conclheight=\ht\@conclbox%
		\setbox\@conclbox=\hbox{$%
			\vlderivationnc{%
				\vlin{#1}{#2}{\box\@conclbox}{#4}%
			}$}%
		\lower\@conclheight\box\@conclbox%
}}
%
\newcommand\vlderidbase[4]{{%
		\setbox\@conclbox=\hbox{$#3$}\relax%
		\@conclheight=\ht\@conclbox%
		\setbox\@conclbox=\hbox{$%
			\vlderivationnc{%
				\vlid{#1}{#2}{\box\@conclbox}{#4}%
			}$}%
		\lower\@conclheight\box\@conclbox%
}}
%
\newcommand\vlderiibase[5]{{%
		\setbox\@conclbox=\hbox{$#3$}\relax%
		\@conclheight=\ht\@conclbox%
		\setbox\@conclbox=\hbox{$%
			\vlderivationnc{%
				\vliin{#1}{#2}{\box\@conclbox}{#4}{#5}%
			}$}%
		\lower\@conclheight\box\@conclbox%
}}
\makeatother
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Equation environments
\newdimen\mydisplayskip
\mydisplayskip=.4\abovedisplayskip
\newenvironment{smallequation}
{\par\nobreak\vskip\mydisplayskip\noindent\bgroup\small\csname equation\endcsname}{\csname endequation\endcsname\egroup}
\newenvironment{smallequation*}
{\par\nobreak\vskip\mydisplayskip\noindent\bgroup\small\csname equation*\endcsname}{\csname endequation*\endcsname\egroup}
\newenvironment{smallalign}
{\par\nobreak\noindent\bgroup\small\csname align\endcsname}{\csname endalign\endcsname\egroup}
\newenvironment{smallalign*}
{\par\nobreak\noindent\bgroup\small\csname align*\endcsname}{\csname endalign*\endcsname\egroup}
%\newenvironment{smallmultline}
%{\par\nobreak\vskipmydisplayskip\noindent\bgroup\small\csname multline*\endcsname}{\csname endmultline*\endcsname\egroup}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Extracting symbols from MnSymbol 
\DeclareFontFamily{U} {MnSymbolC}{}

\DeclareFontShape{U}{MnSymbolC}{m}{n}{
	<-6>  MnSymbolC5
	<6-7>  MnSymbolC6
	<7-8>  MnSymbolC7
	<8-9>  MnSymbolC8
	<9-10> MnSymbolC9
	<10-12> MnSymbolC10
	<12->   MnSymbolC12}{}
\DeclareFontShape{U}{MnSymbolC}{b}{n}{
	<-6>  MnSymbolC-Bold5
	<6-7>  MnSymbolC-Bold6
	<7-8>  MnSymbolC-Bold7
	<8-9>  MnSymbolC-Bold8
	<9-10> MnSymbolC-Bold9
	<10-12> MnSymbolC-Bold10
	<12->   MnSymbolC-Bold12}{}

\DeclareSymbolFont{MnSyC}         {U}  {MnSymbolC}{m}{n}

%\DeclareMathSymbol{\triangleright}{\mathbin}{MnSyC}{80}
\DeclareMathSymbol{\diamondplus}{\mathbin}{MnSyC}{124}
\DeclareMathSymbol{\boxtimes}{\mathbin}{MnSyC}{117}
\DeclareMathSymbol{\meddiamond}{\mathbin}{MnSyC}{110}
\DeclareMathSymbol{\medsquare}{\mathbin}{MnSyC}{106}
\DeclareMathSymbol{\vee}{\mathbin}{MnSyC}{45}
\DeclareMathSymbol{\wedge}{\mathbin}{MnSyC}{44}
\DeclareMathSymbol{\bot}{\mathbin}{MnSyC}{150}
\DeclareMathSymbol{\top}{\mathbin}{MnSyC}{151}
%\DeclareMathSymbol{\forall}{\mathbin}{MnSyC}{166}
%\DeclareMathSymbol{\exists}{\mathbin}{MnSyC}{167}
%\DeclareMathSymbol{\smalldiamond}{\mathbin}{MnSyC}{108}
%\DeclareMathSymbol{\filleddiamond}{\mathbin}{MnSyC}{109}	 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% General maths
\newcommand*\mdelim[3]{%
	\mathopen{}\left#1%
	#3%
	\right#2\mathclose{}%
}

\newcommand*{\tuple}{\mdelim{\langle}{\rangle}}

\newcommand*{\DD}{\mathcal{D}}

\newcommand*{\reducesto}{\quad{\leadsto}\quad}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Connectives
\newcommand*{\NEG}[1]{\bar{#1}}
\newcommand*{\NOT}{\neg}
\newcommand*{\AND}{\mathbin{\scalebox{.85}{\raise.1ex\hbox{\large$\wedge$}}}}
\newcommand*{\TOP}{\mathord{\top}}
\newcommand*{\OR}{\mathbin{\scalebox{.85}{\raise.1ex\hbox{\large$\vee$}}}}
\newcommand*{\BOT}{\mathord{\bot}}
\newcommand*{\IMP}{\mathbin{\scalebox{.6}{\raise.4ex\hbox{\large$\bm\supset$}}}}%\supset}}%

\newcommand*{\BOX}{\mathord{\medsquare}}
\newcommand*{\DIA}{\mathord{\scalebox{.9}{\raise.1ex\hbox{$\meddiamond$}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Logic
\newcommand*{\ax}[1]{\mathsf{#1}}
\newcommand*{\kax}[1][]		{\ax{k_{#1}}}

\newcommand*{\A}{\mathcal{A}}
\newcommand*{\F}{\mathcal{F}}
\newcommand*{\M}{\mathfrak{M}}

\newcommand{\force}[2]{#1\Vdash#2}
\newcommand{\nforce}[2]{#1\nVdash#2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Systems
\newcommand*{\sys}[1]{\ensuremath{\mathsf{#1}}}%\xspace}
\newcommand*{\K}{\sys{K}}
\newcommand*{\IK}{\sys{IK}}
\newcommand*{\CK}{\sys{CK}}

\newcommand*{\lab}{\mathsf{lab}}
\newcommand*{\labK}{\lab\K}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Labelled sequents
\newcommand{\SEQ}{\Rightarrow}

\newcommand*{\Labx}{\mathcal{L}}
\newcommand*{\Rabx}{\mathcal{R}}
\newcommand*{\Gx}{\mathcal{G}}
\newcommand*{\Bx}{\mathcal{B}}
\newcommand*{\labels}[2]{{\color{blue}{#1}\:\colon}{#2}}
\newcommand*{\rel}{R}

\newcommand*{\BBot}{\Perp} % \usepackage{cmll} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Rules
\newcommand*{\rn}[1]  {\ensuremath{\mathsf{#1}}}
\newcommand*{\invr}[1]{#1^\bullet}
%
\newcommand*{\orn}[2][]  {\rn{#2}_{#1}}%^{\lab}}}
\newcommand*{\rrn}[2][]  {\rn{#2}_{R#1}}%^\lab}}
\newcommand*{\lrn}[2][]  {\rn{#2}_{L#1}}%^\lab}}
%
\newcommand*{\labrn}[2][]  {\rn{#2}_{#1}}%^{\lab}}}
\newcommand*{\rlabrn}[2][]  {\rn{#2}_{R#1}}%^\lab}}
\newcommand*{\llabrn}[2][]  {\rn{#2}_{L#1}}%^\lab}}
%
\newcommand*{\brsym}{\mathord{\scalebox{.9}{$\boxtimes$}}}
\newcommand*{\boxbrn}[1]{\rn{\brsym_\rn{#1}}}%^{\lab}}}
\newcommand*{\diasym}{\mathord{\diamondplus}}
\newcommand*{\diabrn}[1][]{\rn{\diasym_\rn{#1}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Nested sequents
\makeatletter
%\newcommand*\BR[2][]{\mdelim{\lbrack\strut^{#1}}{\rbrack}{#2}}
\newcommand*{\BR}{%
	\@ifnextchar\i{\br@two}{%
		\@ifnextchar\bgroup{\br@one}{% 
}}}
\newcommand*{\br@one}[1]{%
	\def\br@{#1}%
	\mdelim{\lbrack}{\rbrack}{\ifx\br@\empty\mkern 3mu\else #1\fi}%
}
\newcommand*{\br@two}[3]{%
	\def\br@{#3}%
	\mdelim{\lbrack\strut^{#2}}{\rbrack}{\ifx\br@\empty\mkern 3mu\else #3\fi}%
}
%
\newcommand*{\bBR}{%
	\@ifnextchar\i{\bbr@two}{%
		\@ifnextchar\bgroup{\bbr@one}{% 
}}}
\newcommand*{\bbr@one}[1]{%
	\def\br@{#1}%
	\mdelim{\llbracket}{\rrbracket}{\ifx\br@\empty\mkern 3mu\else #1\fi}%
}
\newcommand*{\bbr@two}[3]{%
	\def\br@{#3}%
	\mdelim{\llbracket\strut^{#2}}{\rrbracket}{\ifx\br@\empty\mkern 3mu\else #3\fi}%
}
%
%\newcommand*{\@makeoperator}[2]{
%	\newcommand*{#1}{%
%		\mathrm{#2}\mdelim{\lparen}{\rparen}
%	}
%}
%%
%\@makeoperator{\fm}{fm^{\n}}
%\@makeoperator{\ofm}{fm^{\o}}
%\@makeoperator{\hfm}{fm^{\h}}
%%
%\@makeoperator{\depth}{dp}
%\@makeoperator{\rank}{rk}
%\@makeoperator{\height}{ht}
%\@makeoperator{\tree}{tree}
%\@makeoperator{\graph}{graph}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% contexts
\makeatletter
\newcommand*{\cxs}{%
	\@ifnextchar\i{\cxs@two}{%
		\@ifnextchar\bgroup{\cxs@one}{% % \bgroup is the same as {
}}}
\newcommand*{\cxs@one}[1]{%
	\def\cxs@{#1}%
	\mdelim{\lbrace}{\rbrace}{\ifx\cxs@\empty\mkern 3mu\else #1\fi}%
	\cxs@one@decor%
}
\newcommand*{\cxs@two}[3]{%
	\def\cxs@{#3}%
	\mdelim{\lbrace\strut^{#2}}{\rbrace}{\ifx\cxs@\empty\mkern 3mu\else #3\fi}%
	\cxs@one@decor%
}
\def\cxs@one@decor{%
	\@ifnextchar_{\cxs@one@sub}{%
		\@ifnextchar^{\cxs@one@sup}{%
			\@ifnextchar\dots{\@firstoftwo{\dotsm\cxs@one@decor}}{%
				\@ifnextchar[{\cxs@one@arg}%]
				\cxs}}}%
}
\def\cxs@one@sub_#1{_{#1}\cxs@one@decor}
\def\cxs@one@sup^#1{^{#1}\cxs@one@decor}
\def\cxs@one@arg[#1]{{#1}\cxs@one@decor}

%% Change these as needed, but keep the \cx@continuation at the end
\def\cx@delete@always#1{{#1}^{\ast}\cx@continuation}
\def\cx@delete@right#1*{{#1}^{\star}\cx@continuation}
\def\cx@delete@focus#1\f{{#1}^{\scriptscriptstyle\not{\langle}{\rangle}}\cx@continuation}

\def\cx@delete@star#1*{%
	\@ifnextchar*{\cx@delete@right{#1}}{\cx@delete@always{#1}}%
}

\newcommand*{\@makecontextual}[2]{
	\newcommand*{#1}{%
		\@ifnextchar*{\cx@delete@star{#2}}{%
			\@ifnextchar\f{\cx@delete@focus{#2}}{%
				#2\cx@continuation}}%
	}%
}
\newcommand*{\cx@continuation}[1][]{_{#1}\cxs}

\@makecontextual{\Ex}{}

\@makecontextual{\Cx}{\Gamma}
\@makecontextual{\Dx}{\Delta}
\@makecontextual{\Lx}{\Lambda}
\@makecontextual{\Rx}{\Pi}

\@makecontextual{\LLx}{\Omega}
\@makecontextual{\RRx}{\Xi}
\@makecontextual{\CCx}{\Sigma}
\@makecontextual{\DDx}{\Theta}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% intuitionistic
\newcommand*{\rt}[1]{#1^\circ}
\newcommand*{\lf}[1]{#1^\bullet}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
	
\maketitle

The reference work on proof theory for intuitionistic modal logics is Simpson's PhD thesis~\cite{simpson:phd94}.

\section{Classical modal logic}

\subsection{Syntax}

The language of classical modal logic is obtained from the one of classical propositional logic by adding the modal connectives $\BOX$ and $\DIA$, standing for example for \emph{necessity} and \emph{possibility}.
%
Starting with a set $\A$ of atomic propositions denoted $a$ and their duals $\NEG a$, modal formulas are constructed from the following grammar:
%
\begin{align*}
	A \coloncolonequals & \quad a \mid \NEG a \mid A \AND A \mid \TOP \mid A \OR A \mid \BOT \mid \BOX A \mid \DIA A 
\end{align*}
%
In a classical setting, we always assume that formulas are in negation normal form, that is, negation is restricted to atoms. 
%
When we write $\NOT A$ in this case, we mean the result of computing the de Morgan dual of connectives and atomic propositions within $A$,
i.e.~$\NOT{\NOT A} \equiv A$, $\NOT(A\AND B) \equiv \NOT A\OR\NOT B$ and $\NOT{\BOX A} \equiv \DIA \NOT A$, where $\equiv$ denotes syntactic equality.
%
Implication can be defined from this set of connectives by $A \IMP B \colonequals \NOT A \OR B$.
%
$\TOP$ and $\BOT$ are the usual \emph{units} of the binary connectives $\AND$ and $\OR$ respectively.

The classical modal logic $\K$ is then obtained from classical propositional logic by adding:
%
\begin{itemize}
	\item the \emph{necessitation} rule: if $A$ is a theorem of $\K$ then $\BOX A$ is too; and
	\item the axiom of \emph{distributivity} $\kax \colonequals \BOX(A \IMP B) \IMP (\BOX A \IMP \BOX B)$.
\end{itemize}	

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Semantics}

Kripke gave the first systematic treatment of \emph{possible-worlds semantics} (therefore also known as Kripke semantics).
%
One starts with a graph:
%
a \emph{frame} $\F$ is a pair $\tuple{W, R}$ of a non-empty set $W$ of \emph{possible worlds} and a binary relation $R \subseteq W \times W$, called the \emph{accessibility relation}.	
%
Then one adds a mechanism to evaluate formulas:
%
a \emph{model} $\M$ is a frame together with a \emph{valuation} function $V\colon W\to2^\A$, which assigns to each world $w$ a subset of propositional variables that are ``true'' in $w$. 
%
The \emph{truth} of a modal formula at a world $w$ in a relational structure is the smallest relation $\force{}{}$ satisfying:
%
\begin{equation*}
	\begin{array}{l@{\quad\mbox{iff}\quad}l}
		\force{w}{a} & a \in V(w)\\
		\force{w}{\NEG{a}} & a \not\in V(w)\\
		\force{w}{A \AND B} & \force{w}{A} \mbox{ and } \force{w}{B}\\
		\force{w}{A \OR B} & \force{w}{A} \mbox{ or } \force{w}{B}\\
		\force{w}{\BOX A} & \mbox{for all } v \in W \mbox{ such that } (w,v) \in R \mbox{ one has } \force{v}{A}\\
		\force{w}{\DIA A} & \mbox{there exists } v \in W \mbox{ such that } (w,v) \in R \mbox{ and } \force{v}{A}
	\end{array}
\end{equation*}

We say that a formula $A$ is \emph{satisfied in a model} $\M = \tuple{W, R, V}$, denoted by $\M \models A$, if for every $w \in W$, $\force{w}{A}$. 
%
We say that a formula $A$ is \emph{valid in a frame} $\F = \tuple{W,R}$, denoted by $\F \models A$, if for every valuation $V$, $\tuple{W, R, V} \models A$. 

\begin{theorem}[Kripke~\cite{kripke:mlq63}]
	A formula $A$ is a theorem of $\sys{K}$ if and only if $A$ is valid in every frame.
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Labelled proof theory}

Labelled sequents are formed from by \emph{labelled formulas} of the form $\labels{x}{A}$ and \emph{relational atoms} of the form $x \rel y$ , where $x, y$ range over a set of variables (called \emph{labels}) and $A$ is a modal formula.
%
A (one-sided) labelled sequent is then of the form $\Gx \SEQ \Rabx$ where $\Gx$ denotes a set of relational atoms and $\Rabx$ a multiset of labelled formulas.	
%
A simple proof system (shown on Figure~\ref{fig:labK}) for classical modal logic $\K$ can be obtained in this formalism.

\begin{figure}
	\small
	\fbox{
		\begin{minipage}{.95\textwidth}
			\centering
			$
			\vlinf{\labrn{id}}{}{\Gx\SEQ \Rabx, \labels{x}{a}, \labels{x}{\NEG a}}{}
			\quad
			\vlinf{\labrn\TOP}{}{\Gx \SEQ \Rabx, \labels{x}{\TOP}}{}
			$
			\\[1ex]
			$
			\vliinf{\labrn\AND}{}{\Gx \SEQ \Rabx, \labels{x}{A \AND B}}{\Gx \SEQ \Rabx, \labels{x}{A}}{\Gx \SEQ \Rabx, \labels{x}{B}}
			\quad
			\vlinf{\labrn\OR}{}{\Gx \SEQ \Rabx, \labels{x}{A \OR B}}{\Gx \SEQ \Rabx, \labels{x}{A}, \labels{x}{B}}
			$
			\\[1ex]
			$
			\vlinf{\labrn\BOX}{\text{\footnotesize $y$ is fresh}}{\Gx \SEQ \Rabx, \labels{x}{\BOX A}}{\Gx, x \rel y \SEQ \Rabx, \labels{y}{A}}
			\quad
			\vlinf{\labrn\DIA}{}{\Gx, x \rel y \SEQ \Rabx, \labels{x}{\DIA A}}{\Gx, x \rel y \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}}
			$
		\end{minipage}
	}
	\caption{System $\labK$}
	\label{fig:labK}
\end{figure}

\begin{theorem}[Negri~\cite{negri:jpl05}]
	A formula $A$ is provable in the calculus $\labK$ if and only if $A$ is valid in every frames.
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Intuitionistic modal logic}

\subsection{Syntax}

In the intuitionistic case, we work with a different set of connectives.
%
Starting with a set $\A$ of atomic propositions still denoted $a$, formulas are constructed from the following grammar:
%
\begin{align*}
A & \coloncolonequals
a \mid A \AND A \mid \TOP \mid A \OR A \mid \BOT \mid A \IMP A \mid \BOX A \mid \DIA A
\end{align*}
%
When we write $\NOT A$ in this case, we mean $A \IMP \BOT$.

Obtaining the intuitionistic variant of $\K$ is more involved than the classical variant.
%
Lacking De Morgan duality, there are several variants of $\kax$ that are classically but not intuitionistically equivalent.
%
Five axioms have been considered as primitives in the literature.
%
The intuitionistic modal logic $\IK$ is obtained from ordinary intuitionistic propositional logic by adding:
%
\begin{itemize}
	\item the \emph{necessitation rule}: $\BOX A$ is a theorem if $A$ is a theorem; and
	\item the following five variants of the $\kax$ axiom.
	%
	\begin{equation*}
	\label{eq:ik}\hskip-2em
	\begin{array}[t]{r@{\;}l}
	\kax[1]\colon&\BOX(A\IMP B)\IMP(\BOX A\IMP\BOX B)\\%[1ex]
	\kax[2]\colon&\BOX(A\IMP B)\IMP(\DIA A\IMP\DIA B)\\%[1ex]
	\end{array}
	\qquad
	\begin{array}[t]{r@{\;}l}
	\kax[3]\colon&\DIA(A\OR B)\IMP(\DIA A\OR\DIA B)\\%[1ex]
	\kax[4]\colon&(\DIA A\IMP \BOX B)\IMP\BOX(A\IMP B)\\%x[1ex]
	\end{array}
	\qquad
	\begin{array}[t]{r@{\;}l}
	\kax[5]\colon&\DIA\BOT\IMP\BOT
	\end{array}
	\end{equation*}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Semantics}

The Kripke semantics for $\IK$ combines the Kripke semantics for intuitionistic propositional logic and the one for classical modal logic, using two distinct relations on the set of worlds. 
%
So, a \emph{bi-relational frame} $\F$ is a triple $\tuple{W, \le, R}$ of a non-empty set of worlds $W$ with two binary relations: $R \subseteq W \times W$ and $\le$ a pre-order on $W$ (\emph{i.e.} a reflexive and transitive relation) satisfying the conditions:
\begin{itemize}
	\item[(F1)] For all worlds $u, v, v'$, if $u R v$ and $v \le v'$, there exists a $u'$ such that $u \le u'$ and $u' R v'$:
	\begin{equation*}
	\xymatrix{
		u' \ar@{.>}[r]_R  & v' \\
		u \ar@{.>}[u]^{\le} \ar@{->}[r]_R  & v \ar@{->}[u]_{\le}
	}
	\end{equation*}
	
	\item[(F2)] For all worlds $u', u, v$, if $u \le u'$ and $u R v$, there exists a $v'$ such that $u' R v'$ and $v \le v'$:
	\begin{equation*}
	\xymatrix{
		u' \ar@{.>}[r]^R & v' \\
		u \ar@{->}[u]^{\le} \ar@{->}[r]^R & v \ar@{.>}[u]_{\le}
	}
	\end{equation*}
\end{itemize}

A \emph{bi-relational model} $\M$ is a quadruple $\tuple{W, \le, R, V}$ with $\tuple{W, \le, R}$ a frame and $V$ a monotone \emph{valuation} function $V\colon W\to2^\A$ which is a function that maps each world $w$ to the subset of propositional atoms that are true in $w$, subject to:
\begin{equation*}
w \le w' \Rightarrow V(w) \subseteq V(w')
\end{equation*}

As in the classical case, we write $\force{w}{a}$ if $a\in V(w)$ and we extend this relation to all formulas by induction, following the rules for both intuitionistic and modal Kripke models:
\begin{equation*}
\begin{array}{l@{\quad\mbox{iff}\quad}l}
\nforce w\BOT \\
\force w{A\AND B} & \mbox{$\force{w}{A}$ and $\force{w}{B}$}\\
\force w{A\OR B} & \mbox{$\force{w}{A}$ or $\force{w}{B}$}\\
\force w{A\IMP B} & \mbox{for all $w'$ with $w\le w'$, if $\force{w'}{A}$ then also $\force{w'}{B}$}\\
\force w{\BOX A} & \mbox{for all $w'$ and $u$ with $w\le w'$ and $w'Ru$, we have $\force{u}{A}$}\\
\force w{\DIA A} & \mbox{there is a $u\in W$ such that $wRu$ and $\force{u}{A}$}
\end{array}
\end{equation*}
%
We write $\nforce{w}{A}$ if it is not the case that $\force wA$, but contrarily to the classical case, we do not have $\force{w}{\neg A}$ iff $\nforce{w}{A}$ (since $\NOT A$ is defined as $A \IMP \BOT$).

%From the monotonicity of the valuation function $V$, we get a monotonicity property for the relation $\force{}{}$ :
%%
%For any formula $A$ and for  $w,w' \in W$, if $w \le w'$ and $\force{w}{A}$, then $\force{w'}{A}$.

We say that a formula~$A$ \emph{is satisfied in a model}~$\M=\tuple{W,R,\le,V}$, if for all $w\in W$ we have $\force{w}{A}$. 
%
A formula~$A$ \emph{is valid in a frame}~$\tuple{W,R,\le}$, if for all valuations $V$, $A$ is satisfied in $\tuple{W,R,\le,V}$

\begin{theorem}[Fischer-Servi~\cite{fischer-servi:84}, Plotkin and Stirling~\cite{plotkin:stirling:86}]
	A formula $A$ is a theorem $\IK$ if and only if $A$ is valid in every bi-relational frame.
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Labelled proof theory}

Echoing to the definition of bi-relational structures, the straightforward extension of labelled deduction to the intuitionistic setting would be to use two sorts of relational atoms, one for the modal relation $\rel$ and another one for the intuitionistic relation $\le$.
%
This is the approach developed by Maffezioli, Naibo and Negri in~\cite{maffezioli:etal:synthese13}.
%
To our knowledge this has not yet been investigated much further, but could be a fruitful perspective.

The idea is to extend labelled sequents with a preorder relation symbol in order to capture intuitionistic modal logics;
%
that is, to define intuitionistic labelled sequents from {labelled formulas} $\labels{x}{A}$, {relational atoms} $x \rel y$, and \emph{preorder atoms} of the form $x \le y$, where $x, y$ range over a set of {labels} and $A$ is an intuitionistic modal formula.
%
A \emph{two-sided intuitionistic labelled sequent} would be of the form $\Bx, \Labx \SEQ \Rabx$ where $\Bx$ denotes a set of relational and preorder atoms, and $\Labx$ and $\Rabx$ are multisets of labelled formulas.	
%
We then would want to obtain a proof system $\lab\heartsuit\IK$ for intuitionistic modal logic $\IK$ in this formalism and prove the following as a new theorem.

\begin{question}
	A formula $A$ is provable in the calculus $\lab\heartsuit\IK$ if and only if $A$ is valid in every bi-relational frame.
\end{question}

\subsection{Answer}

\begin{figure}[h]
	\small
	\fbox{
		\begin{minipage}{.95\textwidth}
			\centering
			$
			\vlinf{\labrn{id}}{}{\Bx, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{}
			\quad
			\vlinf{\llabrn\BOT}{}{\Bx, \Labx, \labels{x}{\BOT} \SEQ \Rabx}{}
			\quad
			\vlinf{\rlabrn\TOP}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{\TOP}}{}
			$
			\\[1ex]
			$
			\vlinf{\llabrn\AND}{}{\Bx, \Labx, \labels{x}{A \AND B} \SEQ \Rabx}{\Bx, \Labx, , \labels{x}{A}, \labels{x}{B} \SEQ \Rabx}
			\quad
			\vliinf{\rlabrn\AND}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \AND B}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{B}}
			$
			\\[1ex]
			$
			\vliinf{\llabrn\OR}{}{\Bx, \Labx, \labels{x}{A \OR B} \SEQ \Rabx}{\Bx, \Labx, \labels{x}{A} \SEQ \Rabx}{\Bx, \Labx, \labels{x}{B} \SEQ \Rabx}
			\quad
			\vlinf{\rlabrn\OR}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \OR B}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A}, \labels{x}{B}}
%			\vlinf{\rlabrn[1]\OR}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \OR B}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A}}
%			\quad
%			\vlinf{\rlabrn[2]\OR}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \OR B}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{B}}
			$
			\\[1ex]
			$
%			\vliinf{\llabrn\IMP}{}{\Bx, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{\Bx, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{x}{A}}{\Bx, \Labx, \labels{x}{B} \SEQ \Rabx}
			\vliinf{\llabrn\IMP}{}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}{\Bx, x \le y, \Labx, \labels{y}{B} \SEQ \Rabx}
			$
			\\[1ex]
			$
			\vlinf{\rlabrn\IMP}{\text{\footnotesize $x'$ fresh}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}}{\Bx, x \le x', \Labx, \labels{x'}{A} \SEQ \Rabx, \labels{x'}{B}}
			$
			\\[1ex]
			$
			\vlinf{\llabrn\BOX}{}{\Bx, x \le u, u \rel v, \Labx, \labels{x}{\BOX A} \SEQ \Rabx}{\Bx, x \le u, u \rel v, \Labx, \labels{x}{\BOX A}, \labels{v}{A} \SEQ \Rabx}
			\quad
			\vlinf{\rlabrn\BOX}{\text{\footnotesize $x',y'$ fresh}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{\BOX A}}{\Bx, x \le x', x' \rel y', \Labx \SEQ \Rabx, \labels{y'}{A}}
			$
			\\[1ex]
			$
			\vlinf{\llabrn\DIA}{\text{\footnotesize $y'$ fresh}}{\Bx, \Labx, \labels{x}{\DIA A} \SEQ \Rabx}{\Bx, x \rel y', \Labx, \labels{y'}{A} \SEQ \Rabx}
			\quad				
			\vlinf{\rlabrn\DIA}{}{\Bx, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}}{\Bx, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}}
			$
			\\[1ex]
			$\mbox{\hbox to .95\linewidth{\dotfill}}$
			\\[1ex]
			$
			\vlinf{\rn{refl}}{}{\Bx, \Labx \SEQ \Rabx}{\Bx, x \le x, \Labx \SEQ \Rabx}
			\quad
			\vlinf{\rn{trans}}{}{\Bx, x \le y, y \le z, \Labx \SEQ \Rabx}{\Bx, x \le y, y \le z, x \le z, \Labx \SEQ \Rabx}
			$
			\\[1ex]
			$
			\vlinf{\labrn{F_1}}{\text{\footnotesize $u$ fresh}}{\Bx, x \rel y, y \le z, \Labx \SEQ \Rabx}{\Bx, x \rel y, y \le z, x \le u, u \rel z, \Labx \SEQ \Rabx}
			\quad
			\vlinf{\labrn{F_2}}{\text{\footnotesize $z$ fresh}}{\Bx, x \rel y, x \le u, \Labx \SEQ \Rabx}{\Bx, x \rel y, y \le z, x \le u, u \rel z,  \Labx \SEQ \Rabx}
			$
		\end{minipage}
	}
	\caption{System $\lab\heartsuit\IK$}
	\label{fig:labhIK}
\end{figure}

\begin{conjecture}\label{thm:cutfree-compl}
	%	Let $\CC$ be a set of geometric frame properties as in~\eqref{eq:cla-geometric} and $\labbrn{\CC}$ be the corresponding set of rules following schema~\eqref{eq:modal-grs}.
	%
	For any formula $A$, the following are equivalent.
	%
	\begin{enumerate}
		\item\label{i} $A$ is a theorem of $\IK$ 
		%
		\item\label{ii} $A$ is provable in $\lab\heartsuit\IK +\labrn{cut}$ where $\labrn{cut}$ is\quad
		\smash{%\fbox{
			$\vliinf{\labrn{cut}}{}{\Bx_1, \Bx_2, \Labx \SEQ \Rabx}{\Bx_1, \Labx \SEQ \Rabx, \labels{z}{C}}{\Bx_2, \Labx, \labels{z}{C} \SEQ \Rabx}$}%}
		%
		\item\label{iii} $A$ is provable in $\lab\heartsuit\IK$
		%
		\item\label{iv} $A$ is valid in every birelational frames %satisfying the properties in $\CC$.
	\end{enumerate}
\end{conjecture}

\begin{proof}[Proof of \ref{ii} $\rightarrow$ \ref{iii}]
	
	By induction on number of cuts + (rank,height) of the left-most top-most cut.
	
	\textbf{Commutative cases:}\label{commutative-cases}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
			\vliin{\llabrn\IMP}{}{\Bx_1, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{z}{C}}{
				\vlhtr{\DD_1}{\Bx_1, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{z}{C}, \labels{y}{A}}
			}{
				\vlhtr{\DD_2}{\Bx_1, x \le y, \Labx, \labels{y}{B} \SEQ \Rabx, \labels{z}{C}}
			}
		}{
			\vlhtr{\DD_3}{\Bx_2, \Labx, \labels{x}{A \IMP B}, \labels{z}{C} \SEQ \Rabx}
		}
		\reducesto
	\end{smallequation*}
	
	\begin{smallequation*}\hspace*{-10em}
		\vlderiibase{\llabrn\IMP}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}{
				\vlhtr{\DD_1}{\Bx_1, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{z}{C}, \labels{y}{A}}
			}{
				\vlhtr{\DD_3^{\rn w}}{\Bx_2, \Labx, \labels{x}{A \IMP B}, \labels{z}{C} \SEQ \Rabx, \labels{y}{A}}
			}
		}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{y}{B} \SEQ \Rabx}{
				\vlhtr{\DD_2}{\Bx_1, x \le y, \Labx, \labels{y}{B} \SEQ \Rabx, \labels{z}{C}}
			}{
				\vlhtr{\DD_3[v/y]^{\invr{\llabrn\IMP}}}{\Bx_2, \Labx, \labels{y}{B}, \labels{z}{C} \SEQ \Rabx}
			}
		}
	\end{smallequation*}
	
	We need to make sure that $y$ does not appear in $\DD_3$, before applying Lemma~\ref{lem:inv}.
	%
	If it does we rewrite it with a fresh variable $v$ first.
	
	%\begin{smallequation*}
	%	\reducesto
	%	\vlderibase{\llabrn{cont}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
	%		\vliin{\llabrn\IMP}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx}{
	%%			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}{
	%%				\vlhtr{\DD_1^{\rn w}}{\Bx_1, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{z}{C}, \labels{y}{A}}
	%%				}{
	%%				\vlhtr{\DD_3^{\rn w}}{\Bx_2, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B}, \labels{z}{C} \SEQ \Rabx}
	%%				}
	%				\vlhtr{\DD_4}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}
	%			}{
	%%			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}{
	%%				\vlhtr{\DD_2^{\rn w}}{\Bx_1, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}
	%%				}{
	%%				\vlhtr{\DD_3^{\rn w}}{\Bx_2, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}
	%%				}
	%				\vlhtr{\DD_5}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}
	%			}
	%		}
	%\end{smallequation*}
	%
	%\begin{smallalign*}&
	%	\text{with } \DD_4 = \quad
	%	\vlderivation{
	%		\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}{
	%			\vlhtr{\DD_1^{\rn w}}{\Bx_1, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{z}{C}, \labels{y}{A}}
	%		}{
	%			\vlhtr{\DD_3^{\rn w}}{\Bx_2, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B}, \labels{z}{C} \SEQ \Rabx, \labels{y}{A}}
	%		}
	%	}
	%	\\&
	%	\text{and } \DD_5 = \quad
	%	\vlderivation{
	%		\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}{
	%			\vlhtr{\DD_2^{\rn w}}{\Bx_1, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}
	%		}{
	%			\vlhtr{\DD_3^{\rn w}}{\Bx_2, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}
	%		}
	%	}
	%\end{smallalign*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}}{
			\vlin{\rlabrn\IMP}{\text{\footnotesize $x'$ fresh}}{\Bx_1, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}, \labels{z}{C}}{
				\vlhtr{\DD_1}{\Bx_1, x \le x', \Labx, \labels{x'}{A} \SEQ \Rabx, \labels{x'}{B}, \labels{z}{C}}
			}
		}{
			\vlhtr{\DD_2}{\Bx_2, \Labx, \labels{z}{C} \SEQ \Rabx, \labels{x}{A \IMP B}}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\reducesto
		\vlderibase{\rlabrn\IMP}{\text{\footnotesize $x''$ fresh (also in $\DD_2$)}}{\Bx_1, \Bx_2, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le x'' \Labx, \labels{x''}{A} \SEQ \Rabx, \labels{x''}{B}}{
				\vlhtr{\DD_1[x''/x']}{\Bx_1, x \le x'', \Labx, \labels{x''}{A} \SEQ \Rabx, \labels{x''}{B}, \labels{z}{C}}
			}{
				\vlhtr{\DD_2^{\invr{\rlabrn\IMP}}}{\Bx_2, x \le x'', \Labx, \labels{z}{C}, \labels{x''}{A} \SEQ \Rabx, \labels{x''}{B}}
			}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A} \SEQ \Rabx}{
			\vlin{\llabrn\BOX}{}{\Bx_1, x \le u, u \rel v, \Labx, \labels{x}{\BOX} \SEQ \Rabx, \labels{z}{C}}{
				\vlhtr{\DD_1}{\Bx_1, x \le u, u \rel v, \Labx, \labels{x}{\BOX A}, \labels{v}{A} \SEQ \Rabx, \labels{z}{C}}
			}
		}{
			\vlhtr{\DD_2}{\Bx_2, \Labx, \labels{x}{\BOX A}, \labels{z}{C} \SEQ \Rabx}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\reducesto
		\vlderibase{\llabrn\BOX}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A} \SEQ \Rabx}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A}, \labels{v}{A} \SEQ \Rabx}{
				\vlhtr{\DD_1}{\Bx_1, x \le u, u \rel v, \Labx, \labels{x}{\BOX A}, \labels{v}{A} \SEQ \Rabx, \labels{z}{C}}
			}{
				\vlhtr{\DD_2^{\rn w}}{\Bx_2, \Labx, \labels{x}{\BOX A}, \labels{v}{A}, \labels{z}{C} \SEQ \Rabx}
			}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, \Labx \SEQ \Rabx, \labels{x}{\BOX A}}{
			\vlin{\rlabrn\BOX}{\text{\footnotesize $x',y'$ fresh}}{\Bx_1, \Labx \SEQ \Rabx, \labels{x}{\BOX A}, \labels{z}{C}}{
				\vlhtr{\DD_1}{\Bx_1, x \le x', x' \rel y' \Labx \SEQ \Rabx, \labels{y'}{A}, \labels{z}{C}}
			}
		}{
			\vlhtr{\DD_2}{\Bx_2, \Labx, \labels{z}{C} \SEQ \Rabx, \labels{x}{\BOX A}}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\reducesto
		\vlderibase{\rlabrn\BOX}{\text{\footnotesize $u,v$ fresh (also in $\DD_2$)}}{\Bx_1, \Bx_2, \Labx \SEQ \Rabx, \labels{x}{\BOX A}}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx \SEQ \Rabx, \labels{v}{A}}{
				\vlhtr{\DD_1}{\Bx_1, x \le u, u \rel v, \Labx \SEQ \Rabx, \labels{v}{A}, \labels{z}{C}}
			}{
				\vlhtr{\DD_2^{\invr{\rlabrn\BOX}}}{\Bx_1, x \le u, u \rel v, \Labx, \labels{z}{C} \SEQ \Rabx, \labels{v}{A}}
			}
		}
	\end{smallequation*}
	
	\begin{smallequation*}\hspace*{-7em}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, \Labx, \labels{x}{\DIA A} \SEQ \Rabx}{
			\vlin{\llabrn\DIA}{\text{\footnotesize $y'$ fresh}}{\Bx_1, \Labx, \labels{x}{\DIA A} \SEQ \Rabx, \labels{z}{C}}{
				\vlhtr{\DD_1}{\Bx_1, x \rel y', \Labx, \labels{y'}{A} \SEQ \Rabx, \labels{z}{C}}
			}
		}{
			\vlhtr{\DD_2}{\Bx_2, \Labx, \labels{x}{\DIA A}, \labels{z}{C} \SEQ \Rabx}
		}
		\reducesto
		\vlderibase{\llabrn\DIA}{\text{\footnotesize $y''$ fresh (also in $\DD_2$)}}{\Bx_1, \Bx_2, \Labx, \labels{x}{\DIA A} \SEQ \Rabx}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \rel y'', \Labx, \labels{y''}{A} \SEQ \Rabx}{
				\vlhtr{\DD_1[y''/y']}{\Bx_1, x \rel y'', \Labx, \labels{y''}{A} \SEQ \Rabx, \labels{z}{C}}
			}{
				\vlhtr{\DD_2^{\invr{\llabrn\DIA}}}{\Bx_2, \Labx, \labels{y''}{A}, \labels{z}{C} \SEQ \Rabx}
			}
		}
	\end{smallequation*}
	
	\begin{smallequation*}\hspace*{-10em}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}}{
			\vlin{\rlabrn\DIA}{}{\Bx_1, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}, \labels{z}{C}}{
				\vlhtr{\DD_1}{\Bx_1, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}, \labels{z}{C}}
			}
		}{
			\vlhtr{\DD_2}{\Bx_2, \Labx, \labels{z}{C} \SEQ \Rabx, \labels{x}{\DIA A}}
		}
		\reducesto
%	\end{smallequation*}
%	
%	\begin{smallequation*}
		\vlderibase{\rlabrn\DIA}{}{\Bx_1, \Bx_2, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}}{
				\vlhtr{\DD_1}{\Bx_1, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}, \labels{z}{C}}
			}{
				\vlhtr{\DD_2^{\rn w}}{\Bx_2, \Labx, \labels{z}{C} \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}}
			}
		}
	\end{smallequation*}
	
	\textbf{Key cases:}\label{key-cases}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx}{
			\vlin{\labrn{id}}{}{\Bx_1, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{
				\vlhy{}	
			}
		}{
			\vlhtr{\DD_2}{\Bx_2, \Labx, \labels{x}{a}, \labels{y}{a} \SEQ \Rabx}		
		}
		\reducesto
		\vlderibase{\llabrn{mon}}{}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx}{
			\vlhtr{\DD_2^{\rn w}}{\Bx_1, \Bx_2, x \le y, \Labx, \labels{x}{a}, \labels{y}{a} \SEQ \Rabx}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx \SEQ \Rabx, \labels{y}{a}}{
			\vlhtr{\DD_1}{\Bx_1, \Labx \SEQ \Rabx, \labels{x}{a}, \labels{y}{a}}		
		}{
			\vlin{\labrn{id}}{}{\Bx_2, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{
				\vlhy{}	
			}
		}
		\reducesto
		\vlderibase{\rlabrn{mon}}{}{\Bx_1, \Bx_2, x \le y, \Labx \SEQ \Rabx, \labels{y}{a}}{
			\vlhtr{\DD_1^{\rn w}}{\Bx_1, \Bx_2, x \le y, \Labx \SEQ \Rabx, \labels{x}{a}, \labels{y}{a}}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, \Bx_3, x \le y, \Labx \SEQ \Rabx}{
			\vlin{\rlabrn\IMP}{}{\Bx_1, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}}{
				\vlhtr{\DD_1}{\Bx_1, x \le x', \Labx, \labels{x'}{A} \SEQ \Rabx, \labels{x'}{B}}
			}
		}{
			\vliin{\llabrn\IMP}{}{\Bx_2, \Bx_3, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
				\vlhtr{\DD_2}{\Bx_2, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}
			}{
				\vlhtr{\DD_3}{\Bx_3, x \le y, \Labx, \labels{y}{B} \SEQ \Rabx}
			}
		}
		\reducesto
	\end{smallequation*}
	
	\begin{smallequation*}
		\hspace*{-7em}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, \Bx_3, x \le y, \Labx \SEQ \Rabx}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le y, \Labx \SEQ \Rabx, \labels{y}{A}}{
				\vlin{\rlabrn\IMP}{}{\Bx_1, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}, \labels{y}{A}}{
					\vlhtr{\DD_1^{\rn w}}{\Bx_1, x \le x', \Labx, \labels{x'}{A} \SEQ \Rabx, \labels{x'}{B}, \labels{y}{A}}
				}
				%			\vlhtr{\DD_{1\rn w}'}{\Bx_1, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}, \labels{y}{A}}
			}{
				\vlhtr{\DD_{2}}{\Bx_2, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}
			}
		}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_3, x \le y, \Labx, \labels{y}{A} \SEQ \Rabx}{
				\vlhtr{\DD_1[y/x']}{\Bx_1, x \le y, \Labx, \labels{y}{A} \SEQ \Rabx, \labels{y}{B}}
			}{
				\vlhtr{\DD_3}{\Bx_3, x \le y, \Labx, \labels{y}{B} \SEQ \Rabx}
			}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx \SEQ \Rabx}{
			\vlin{\rlabrn\BOX}{}{\Bx_1, \Labx \SEQ \Rabx, \labels{x}{\BOX A}}{
				\vlhtr{\DD_1}{\Bx_1, x \le x', x' \rel y', \Labx \SEQ \Rabx, \labels{y'}{A}}	
			}
		}{
			\vlin{\llabrn\BOX}{}{\Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A} \SEQ \Rabx}{
				\vlhtr{\DD_2}{\Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A}, \labels{v}{A} \SEQ \Rabx}
			}
		}
		\reducesto
	\end{smallequation*}
	
	\begin{smallequation*}\hspace*{-7em}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx \SEQ \Rabx}{
			%		\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx \SEQ \Rabx, \labels{v}{A}}{
			\vlhtr{\DD_1[u/x',v/y']}{\Bx_1, x \le u, u \rel v, \Labx \SEQ \Rabx, \labels{v}{A}}	
			%			}{
			%			\vlin{\llabrn\BOX}{}{\Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A} \SEQ \Rabx, \labels{v}{A}}{
			%				\vlin{\labrn{id}}{}{\Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A}, \labels{v}{A} \SEQ \Rabx, \labels{v}{A}}{
			%					\vlhy{}
			%					}
			%				}
			%			}
		}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \le u, u \rel v, \Labx, \labels{v}{A} \SEQ \Rabx}{
				\vlin{\rlabrn\BOX}{}{\Bx_1, \Labx, \labels{v}{A} \SEQ \Rabx, \labels{x}{\BOX A}}{
					\vlhtr{\DD_1^{\rn w}}{\Bx_1, x \le x', x' \rel y', \Labx, \labels{v}{A} \SEQ \Rabx, \labels{x}{\BOX A}, \labels{y'}{A}}	
				}
			}{
				\vlhtr{\DD_2}{\Bx_2, x \le u, u \rel v, \Labx, \labels{x}{\BOX A}, \labels{v}{A} \SEQ \Rabx}
			}
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \rel y, \Labx \SEQ \Rabx}{
			\vlin{\rlabrn\DIA}{}{\Bx_1, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}}{
				\vlhtr{\DD_1}{\Bx_1, x \rel y, \Labx \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}}
			}
		}{
			\vlin{\llabrn\DIA}{\text{\footnotesize $y'$ is fresh}}{\Bx_2, \Labx, \labels{x}{\DIA A} \SEQ \Rabx}{
				\vlhtr{\DD_2}{\Bx_2, x \rel y',\Labx, \labels{y'}{A} \SEQ \Rabx}
			}	
		}
	\end{smallequation*}
	
	\begin{smallequation*}
		\vlderiibase{\labrn{cut}}{}{\Bx_1, \Bx_2, x \rel y, \Labx \SEQ \Rabx}{
			\vliin{\labrn{cut}}{}{\Bx_1, \Bx_2, x \rel y, \Labx \SEQ \Rabx, \labels{y}{A}}{
				\vlhtr{\DD_1}{\Bx_1, x \rel y, \Labx \SEQ \Rabx, \labels{y}{A}, \labels{x}{\DIA A}}
			}{
				\vlin{\llabrn\DIA}{\text{\footnotesize $y'$ is fresh}}{\Bx_2, \Labx, \labels{x}{\DIA A} \SEQ \Rabx, \labels{y}{A}}{
					\vlhtr{\DD_2^{\rn w}}{\Bx_2, x \rel y',\Labx, \labels{y'}{A} \SEQ \Rabx, \labels{y}{A}}
				}
			}
		}{
			\vlhtr{\DD_2[y/y']}{\Bx_2, x \rel y,\Labx, \labels{y}{A} \SEQ \Rabx}
		}
	\end{smallequation*}
	
\end{proof}


\begin{lemma}\label{lem:mon-adm}
The following rules are admissible in $\lab\heartsuit\IK$.
$$
\vlinf{\llabrn{mon}}{}{\Bx, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx}{\Bx, x \le y, \Labx, \labels{x}{a}, \labels{y}{a} \SEQ \Rabx}
\quad
\vlinf{\rlabrn{mon}}{}{\Bx, x \le y, \Labx \SEQ \Rabx, \labels{y}{a}}{\Bx, x \le y, \Labx \SEQ \Rabx, \labels{x}{a}, \labels{y}{a}}
$$
\end{lemma}

\begin{proof}
	\begin{smallequation*}
		\vlderivation{
			\vlin{\llabrn{mon}}{}{\Bx, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{x}{a}}{
				\vlin{\labrn{r}}{}{\Bx, x \le y, \Labx, \labels{x}{a}, \labels{y}{a} \SEQ \Rabx, \labels{x}{a}}{
					\vlhy{\Bx', x \le y, \Labx', \labels{x}{a}, \labels{y}{a} \SEQ \Rabx', \labels{x}{a}}
				}
			}
		}
		\reducesto
		\vlderivation{
			\vlin{\labrn{r}}{}{\Bx, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{x}{a}}{
				\vlin{\llabrn{mon}}{}{\Bx', x \le y, \Labx', \labels{x}{a} \SEQ \Rabx', \labels{x}{a}}{
					\vlhy{\Bx', x \le y, \Labx', \labels{x}{a}, \labels{y}{a} \SEQ \Rabx', \labels{x}{a}}
				}
			}
		}
	\end{smallequation*}

	\begin{smallequation*}
	\vlderivation{
		\vlin{\llabrn{mon}}{}{\Bx, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{x}{a}}{
			\vlin{\labrn{id}}{}{\Bx, x \le y, \labels{x}{a}, \labels{y}{a} \SEQ \Rabx, \labels{x}{a}}{
				\vlhy{}
				}
			}
		}
	\reducesto
	\vlinf{\labrn{id}}{}{\Bx, x \le y, \labels{x}{a} \SEQ \Rabx, \labels{x}{a}}{}
	\end{smallequation*}

	\begin{smallequation*}
		\vlderivation{
			\vlin{\llabrn{mon}}{}{\Bx, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{
				\vlin{\labrn{id}}{}{\Bx, x \le y, \labels{x}{a}, \labels{y}{a} \SEQ \Rabx, \labels{y}{a}}{
					\vlhy{}
				}
			}
		}
		\reducesto
		\vlinf{\labrn{id}}{}{\Bx, x \le y, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{}
		\qedhere
	\end{smallequation*}
\end{proof}

\begin{lemma}\label{lem:weak}\hbox{}\quad
	\begin{enumerate}
		\item 
		If there exists a proof 
		$\vlderivation{\vlhtr{\DD}{\Bx, \Labx \SEQ \Rabx, \labels{x}{\BOT}}}$ 
		then there exists a proof 
		$\vlderivation{\vlhtr{\DD^{\bm\BOT}}{\Bx, \Labx \SEQ \Rabx}}$
		
		\item 
		If there exists a proof 
		$\vlderivation{\vlhtr{\DD}{\Bx, \Labx, \labels{x}{\TOP} \SEQ \Rabx}}$ 
		then there exists a proof 
		$\vlderivation{\vlhtr{\DD^{\bm\TOP}}{\Bx, \Labx \SEQ \Rabx}}$
		
		\item 
		If there exists a proof 
		$\vlderivation{\vlhtr{\DD}{\Bx, \Labx \SEQ \Rabx}}$ 
		then there exists a proof 
		$\vlderivation{\vlhtr{\DD^{\rn w}}{\Bx, x \rel y, u \le v, \Labx, \labels{z}{A} \SEQ \Rabx, \labels{w}{B}}}$
	\end{enumerate}
\end{lemma}

\begin{proof}
	Standard
\end{proof}

\begin{lemma}\label{lem:inv}\hbox{}\quad
	\begin{enumerate}
	\item
	If there exists a proof 
	$\vlderivation{\vlhtr{\DD}{\Bx, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}}$ 
	then there exists a proof 
	$\vlderivation{\vlhtr{\DD^{\invr{\llabrn\IMP}}}{\Bx, \Labx, \labels{y}{B} \SEQ \Rabx}}$
	of the same (or smaller) height, for any label $y$ that does not appear in $\DD$.
	
	\item
	If there exists a proof 
	$\vlderivation{\vlhtr{\DD}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}}}$ 
	then there exists a proof 
	$\vlderivation{\vlhtr{\DD^{\invr{\rlabrn\IMP}}}{\Bx, x \le y, \Labx, \labels{y}{A} \SEQ \Rabx, \labels{y}{B}}}$
	of the same (or smaller) height, for any label $y$ that does not appear in $\DD$.
	
	\item 
	If there exists a proof 
	$\vlderivation{\vlhtr{\DD}{\Bx, \Labx \SEQ \Rabx, \labels{x}{\BOX A}}}$ 
	then there exists a proof 
	$\vlderivation{\vlhtr{\DD^{\invr{\rlabrn\BOX}}}{\Bx, x \le u, u \rel v, \Labx \SEQ \Rabx, \labels{v}{A}}}$
	of the same (or smaller) height, for any label $u$ and $v$ that do not appear in $\DD$.
	
	\item 
	If there exists a proof 
	$\vlderivation{\vlhtr{\DD}{\Bx, \Labx, \labels{x}{\DIA A} \SEQ \Rabx}}$ 
	then there exists a proof 
	$\vlderivation{\vlhtr{\DD^{\invr{\llabrn\DIA}}}{\Bx, x \rel y, \Labx, \labels{y}{A} \SEQ \Rabx}}$
	of the same (or smaller) height, for any label $y$ that does not appear in $\DD$.
	
	\end{enumerate}
\end{lemma}

\begin{proof}
%	\todo{check if the constraints on the labels are necessary, i.e., if we could actually define:
%		$\vlderivation{\vlhtr{\DD^{\invr{\llabrn\IMP}}}{\Bx, \Labx, \labels{y}{B} \SEQ \Rabx}}$ and 
%		$\vlderivation{\vlhtr{\DD^{\invr{\rlabrn\IMP}}}{\Bx, \Labx, \labels{y}{A} \SEQ \Rabx, \labels{y}{B}}}$ and
%		$\vlderivation{\vlhtr{\DD^{\invr{\rlabrn\BOX}}}{\Bx, \Labx \SEQ \Rabx, \labels{y}{A}}}$ and
%		$\vlderivation{\vlhtr{\DD^{\invr{\llabrn\DIA}}}{\Bx, \Labx, \labels{y}{A} \SEQ \Rabx}}$
%	}

In each case, we reason by induction on the height of $\DD$.

%Note that in $\lab\heartsuit\IK$ the set of labels appearing in the conclusion of a rule is a subset %(most of the times identical) 
%of the set of labels occurring in the premisses of the rule.
%%
%Therefore, in a proof 
%$
%\DD= 
%\vlderivation{
%	\vlin{\rn r}{}{\Bx, \Labx \SEQ \Rabx}{
%		\vlhtr{\DD'}{\Bx', \Labx' \SEQ \Rabx'}
%		}
%	}
%$
%%
%if a label $y$ does not appear in $\DD'$, then $y$ does \emph{a fortiori} not appear in $\DD$. ($\ast$)

\begin{itemize}
	\item $\llabrn\IMP$:
For a proof of height $1$, it is straightforward.
%
For example, if $\DD = \vlinf{\labrn{id}}{}{\Bx, u \le v, \Labx, \labels{u}{a}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{v}{a}}{}$, 
%
then we take $\DD^{\invr{\llabrn\IMP}}$ to be $\vlinf{\labrn{id}}{}{\Bx, u \le v, \Labx, \labels{u}{a},\labels{y}{B} \SEQ \Rabx, \labels{v}{a}}{}$.

For a proof $\DD$ of height greater than $1$ we have two cases, depending on whether the last rule of $\DD$ acts on $\labels{x}{A \IMP B}$ or only on some part of the context.

First let us fix a given index $y$ that does not appear in $\DD$.

If we start with a proof
\begin{smallequation*}
	\DD = 
	\vlderivation{
		\vlin{\rn{r}}{}{\Bx, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
			\vlhtr{\DD'}{\Bx', \Labx', \labels{x}{A \IMP B} \SEQ \Rabx'}
		}	
	}
\end{smallequation*}

Then by induction hypothesis there exists a proof 
\begin{smallequation*}
	\vlderivation{\vlhtr{{\DD'}^{\invr{\llabrn\IMP}}}{\Bx', \Labx', \labels{y}{B} \SEQ \Rabx'}}
\end{smallequation*}
of the same (or smaller) height as $\DD'$ (as $y$ also does not appear in $\DD'$).

Therefore, we have the proof
\begin{smallequation*}
	\DD^{\invr{\llabrn\IMP}} = 
	\vlderivation{
		\vlin{\rn{r}}{}{\Bx, \Labx, \labels{y}{B} \SEQ \Rabx}{
			\vlhtr{{\DD'}^{\invr{\llabrn\IMP}}}{\Bx', \Labx', \labels{y}{B} \SEQ \Rabx'}
		}
	}
\end{smallequation*}
of the same (or smaller) height as $\DD$.

If we start with a proof 
\begin{smallequation*}
	\vlderivation{
		\vliin{\llabrn\IMP}{\text{\footnotesize $x \le z$ appears in $\Bx$}}{\Bx, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
			\vlhtr{\DD_1}{\Bx, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{z}{A}}
			}{
			\vlhtr{\DD_2}{\Bx, \Labx, \labels{z}{B} \SEQ \Rabx}
			}
		}
\end{smallequation*}
then we take $\DD^{\invr{\llabrn\IMP}}$ to be $\vlderivation{\vlhtr{\DD_2[y/z]}{\Bx, \Labx, \labels{y}{B} \SEQ \Rabx}}$ (as $y$ also does not appear in $\DD_2$) and its height is smaller than the one of $\DD$.

%
\item $\llabrn\DIA$:

If we start with a proof
\begin{smallequation*}
\DD = 
\vlderivation{
	\vlin{\rn{r}}{}{\Bx, \Labx, \labels{x}{\DIA A} \SEQ \Rabx}{
			\vlhtr{\DD'}{\Bx', \Labx', \labels{x}{\DIA A} \SEQ \Rabx'}
			}	
		}
\end{smallequation*}

Then by induction hypothesis there exists a proof 
\begin{smallequation*}
	\vlderivation{\vlhtr{{\DD'}^{\invr{\llabrn\DIA}}}{\Bx', x \rel y, \Labx', \labels{y}{A} \SEQ \Rabx'}}
\end{smallequation*}
of the same (or smaller) height as $\DD'$.

Therefore, we have the proof
\begin{smallequation*}
\DD^{\invr{\llabrn\DIA}} = 
\vlderivation{
	\vlin{\rn{r}}{}{\Bx, x \rel y, \Labx, \labels{y}{A} \SEQ \Rabx}{
		\vlhtr{{\DD'}^{\invr{\llabrn\DIA}}}{\Bx', x \rel y, \Labx', \labels{y}{A} \SEQ \Rabx'}
	}
}
\end{smallequation*}
of the same (or smaller) height as $\DD$, for any label $y$ that does not appear in $\DD$.

If we start with a proof 
\begin{smallequation*}
\vlderivation{
	\vlin{\llabrn\DIA}{\text{\footnotesize $y'$ fresh}}{\Bx, \Labx, \labels{x}{\DIA A} \SEQ \Rabx}{
		\vlhtr{\DD'}{\Bx, x \rel y', \Labx, \labels{y'}{A} \SEQ \Rabx}
		}	
	}
\end{smallequation*}
then we take $\DD^{\invr{\llabrn\DIA}}$ to be $\vlderivation{\vlhtr{\DD'[y/y']}{\Bx, x \rel y, \Labx, \labels{y}{A} \SEQ \Rabx}}$ for any label $y$ that does not appear in $\DD$.

\item $\rlabrn\IMP$ and $\rlabrn\BOX$ : Similar. \qedhere
\end{itemize}
\end{proof}

%\begin{lemma}
%	The following rules are admissible in $\lab\heartsuit\IK$.
%	$$
%	\vlinf{\llabrn{cont}}{}{\Bx, \Labx, \labels{x}{A} \SEQ \Rabx}{\Bx, \Labx, \labels{x}{A}, \labels{x}{A} \SEQ \Rabx}
%	\quad
%	\vlinf{\rlabrn{cont}}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A}, \labels{x}{A}}
%	$$
%\end{lemma}
%
%\begin{proof}
%	\begin{smallequation*}
%		\vlderibase{\llabrn{cont}}{}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
%			\vliin{\llabrn\IMP}{}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx}{
%				\vlhtr{\DD_1}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}
%				}{
%				\vlhtr{\DD_2}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{y}{B} \SEQ \Rabx}
%				}
%			}
%	\end{smallequation*}
%
%	\begin{smallequation*}
%		\reducesto
%		\vlderiibase{\llabrn\IMP}{}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx}{
%			\vlin{\llabrn{cont}}{}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}{
%				\vlhtr{\DD_1}{\Bx, x \le y, \Labx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A}}
%				}
%			}{
%			\vlin{\llabrn{cont}}{}{\Bx, x \le y, \Labx, \labels{y}{B} \SEQ \Rabx}{
%				\vlhtr{\DD_2^{\invr{\llabrn\IMP}}}{\Bx, x \le y, \Labx, \labels{y}{B}, \labels{y}{B} \SEQ \Rabx}
%				}
%			}
%	\end{smallequation*}
%
%	\begin{smallequation*}
%		\vlderibase{\rlabrn{cont}}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}}{
%			\vlin{\rlabrn\IMP}{\text{\footnotesize $x'$ fresh}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}, \labels{x}{A \IMP B}}{
%				\vlhtr{\DD}{\Bx, x \le x', \Labx, \labels{x'}{A} \SEQ \Rabx, \labels{x}{A \IMP B}, \labels{x'}{B}}
%				}
%			}
%		\reducesto
%		\vlderibase{\rlabrn\IMP}{\text{\footnotesize $x'$ fresh}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \IMP B}}{
%			\vliq{\rlabrn{cont}}{}{\Bx, x \le x', \Labx, \labels{x'}{A} \SEQ \Rabx, \labels{x'}{B}}{
%				\vlhtr{\DD^{\invr{\rlabrn\IMP}}}{\Bx, x \le x',\Labx, \labels{x'}{A}, \labels{x'}{A} \SEQ \Rabx, \labels{x'}{B}, \labels{x'}{B}}
%				}
%			}
%	\end{smallequation*}
%\end{proof}

\begin{lemma}
	The following rule is admissible in $\lab\heartsuit\IK$: 
	$\vlinf{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{A} \SEQ \Rabx, \labels{y}{A}}{}$
\end{lemma}

\begin{proof}
	By induction of the size of $A$.
	\begin{smallequation*}
		\vlinf{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{}
		\reducesto
		\vlinf{\labrn{id}}{}{\Bx, x \le y; \Labx, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{}
	\end{smallequation*}
	\begin{smallequation*}
		\vlinf{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{A \AND B} \SEQ \Rabx, \labels{y}{A \AND B}}{}
		\reducesto
	\end{smallequation*}
	\begin{smallequation*}
		\vlderivation{
			\vlin{\llabrn\AND}{}{\Bx, x \le y; \Labx, \labels{x}{A \AND B} \SEQ \Rabx, \labels{y}{A \AND B}}{
				\vliin{\rlabrn\AND}{}{\Bx, x \le y; \Labx, \labels{x}{A}, \labels{x}{B} \SEQ \Rabx, \labels{y}{A \AND B}}{
					\vlin{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{A}, \labels{x}{B} \SEQ \Rabx, \labels{y}{A}}{
						\vlhy{}
						}
					}{
					\vlin{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{A}, \labels{x}{B} \SEQ \Rabx, \labels{y}{B}}{
						\vlhy{}
						}
					}
				}
			}
	\end{smallequation*}

	\begin{smallequation*}
		\vlinf{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{A \OR B} \SEQ \Rabx, \labels{y}{A \OR B}}{}
		\reducesto
	\end{smallequation*}
	\begin{smallequation*}
		\vlderivation{
			\vliin{\llabrn\OR}{}{\Bx, x \le y; \Labx, \labels{x}{A \OR B} \SEQ \Rabx, \labels{y}{A \OR B}}{
				\vlin{\rlabrn\OR}{}{\Bx, x \le y; \Labx, \labels{x}{A} \SEQ \Rabx, \labels{y}{A \OR B}}{
					\vlin{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{A} \SEQ \Rabx, \labels{y}{A}}{
						\vlhy{}
						}
					}
				}{
				\vlin{\rlabrn\OR}{}{\Bx, x \le y; \Labx, \labels{x}{B} \SEQ \Rabx, \labels{y}{A \OR B}}{
					\vlin{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{B} \SEQ \Rabx, \labels{y}{B}}{
						\vlhy{}
						}
					}
				}
			}
	\end{smallequation*}

	\begin{smallequation*}
		\vlinf{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A \IMP B}}{}
		\reducesto
	\end{smallequation*}
	\begin{smallequation*}\hspace*{-10em}
		\vlderivation{
			\vlin{\rlabrn\IMP}{}{\Bx, x \le y; \Labx, \labels{x}{A \IMP B} \SEQ \Rabx, \labels{y}{A \IMP B}}{
				\vlin{trans}{}{\Bx, x \le y, y \le z; \Labx, \labels{x}{A \IMP B}, \labels{z}{A} \SEQ \Rabx, \labels{z}{B}}{
					\vliin{\llabrn\IMP}{}{\Bx, x \le y, y \le z, x \le z; \Labx, \labels{x}{A \IMP B}, \labels{z}{A} \SEQ \Rabx, \labels{z}{B}}{
						\vlin{refl}{}{\Bx, x \le y, y \le z, x \le z; \Labx, \labels{x}{A \IMP B}, \labels{z}{A} \SEQ \Rabx, \labels{z}{B}, \labels{z}{A}}{
							\vlin{\labrn{id_g}}{}{\Bx, x \le y, y \le z, x \le z, z \le z; \Labx, \labels{x}{A \IMP B}, \labels{z}{A} \SEQ \Rabx, \labels{z}{B}, \labels{z}{A}}{
								\vlhy{}
								}
							}
						}{
						\vlin{refl}{}{\Bx, x \le y, y \le z, x \le z; \Labx, \labels{z}{B}, \labels{z}{A} \SEQ \Rabx, \labels{z}{B}}{
							\vlin{\labrn{id_g}}{}{\Bx, x \le y, y \le z, x \le z, z \le z; \Labx, \labels{z}{B}, \labels{z}{A} \SEQ \Rabx, \labels{z}{B}}{
								\vlhy{}
								}
							}
						}
					}
				}
			}
	\end{smallequation*}

	\begin{smallequation*}
		\vlinf{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{\BOX A} \SEQ \Rabx, \labels{y}{\BOX A}}{}
		\reducesto
	\end{smallequation*}
	\begin{smallequation*}
		\vlderivation{
			\vlin{\rlabrn\BOX}{}{\Bx, x \le y; \Labx, \labels{x}{\BOX A} \SEQ \Rabx, \labels{y}{\BOX A}}{
				\vlin{trans}{}{\Bx, x \le y, y \le z, z \rel w; \Labx, \labels{x}{\BOX A} \SEQ \Rabx, \labels{w}{A}}{
					\vlin{\llabrn\BOX}{}{\Bx, x \le y, y \le z, x \le z, z \rel w; \Labx, \labels{x}{\BOX A} \SEQ \Rabx, \labels{w}{A}}{
						\vlin{refl}{}{\Bx, x \le y, y \le z, x \le z, z \rel w; \Labx, \labels{z}{\BOX A}, \labels{w}{A} \SEQ \Rabx, \labels{w}{A}}{
							\vlin{\labrn{id_g}}{}{\Bx, x \le y, y \le z, x \le z, z \rel w, w \le w; \Labx, \labels{z}{\BOX A}, \labels{w}{A} \SEQ \Rabx, \labels{w}{A}}{
								\vlhy{}
								}
							}
						}
					}
				}
			}
	\end{smallequation*}

	\begin{smallequation*}
		\vlinf{\labrn{id_g}}{}{\Bx, x \le y; \Labx, \labels{x}{\DIA A} \SEQ \Rabx, \labels{y}{\DIA A}}{}
		\reducesto
	\end{smallequation*}
	\begin{smallequation*}
		\vlderivation{
			\vlin{\llabrn\DIA}{}{\Bx, x \le y; \Labx, \labels{x}{\DIA A} \SEQ \Rabx, \labels{y}{\DIA A}}{
				\vlin{\color{red}{F_2}}{}{\Bx, x \le y, x \rel z; \Labx, \labels{z}{A} \SEQ \Rabx, \labels{y}{\DIA A}}{
					\vlin{\rlabrn\DIA}{}{\Bx, x \le y, x \rel z, z \le u, y \rel u; \Labx, \labels{z}{A} \SEQ \Rabx, \labels{y}{\DIA A}}{
						\vlin{\labrn{id_g}}{}{\Bx, x \le y, x \rel z, z \le u, y \rel u; \Labx, \labels{z}{A} \SEQ \Rabx, \labels{y}{\DIA A}, \labels{u}{A}}{
							\vlhy{}
							}
						}
					}
				}
		}
	\end{smallequation*}
	
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Comparaison with Simpson's $\lab\IK$}

\begin{figure}
	\small
	\fbox{
		\begin{minipage}{.95\textwidth}
			\centering
			$
			\vlinf{\labrn{id}}{}{\Gx, \Labx, \labels{x}{a} \SEQ \labels{x}{a}}{}
			\quad
			\vlinf{\llabrn\BOT}{}{\Gx, \Labx, \labels{x}{\BOT} \SEQ \labels{z}{A}}{}
			$
			\\[1ex]
			$
			\vlinf{\llabrn\AND}{}{\Gx, \Labx, \labels{x}{A\AND B} \SEQ \labels{z}{C}}{\Gx, \Labx, \labels{x}{A}, \labels{x}{B} \SEQ \labels{z}{C}}
			\quad
			\vliinf{\rlabrn\AND}{}{\Gx, \Labx \SEQ \labels{x}{A \AND B}}{\Gx, \Labx \SEQ \labels{x}{A}}{\Labx \SEQ \labels{x}{B}}
			$
			\\[1ex]
			$
			\vliinf{\llabrn\OR}{}{\Gx, \Labx, \labels{x}{A \OR B} \SEQ \labels{z}{C}}{\Gx, \Labx, \labels{x}{A} \SEQ \labels{z}{C}}{\Gx, \Labx, \labels{x}{B} \SEQ \labels{z}{C}}
			\quad
			\vlinf{\rlabrn[1]\OR}{}{\Gx, \Labx \SEQ \labels{x}{A \OR B}}{\Gx, \Labx \SEQ \labels{x}{A}}
			\quad
			\vlinf{\rlabrn[2]\OR}{}{\Gx, \Labx \SEQ \labels{x}{A \OR B}}{\Gx, \Labx \SEQ \labels{x}{B}}
			$
			\\[1ex]
			$
			\vliinf{\llabrn\IMP}{}{\Gx, \Labx, \labels{x}{A \IMP B} \SEQ \labels{z}{C}}{\Gx, \Labx \SEQ \labels{x}{A}}{\Gx, \Labx, \labels{x}{B} \SEQ \labels{z}{C}}
			\quad
			\vlinf{\rlabrn\IMP}{}{\Gx, \Labx \SEQ \labels{x}{A \IMP B}}{\Gx, \Labx, \labels{x}{A} \SEQ \labels{x}{B}}
			$
			\\[1ex]
			$
			\vlinf{\llabrn\BOX}{}{\Gx, x \rel y, \Labx, \labels{x}{\BOX A} \SEQ \labels{z}{B}}{\Gx, x \rel y, \Labx, \labels{x}{\BOX A}, \labels{y}{A} \SEQ \labels{z}{B}}
			\quad
			\vlinf{\rlabrn\BOX}{\text{\footnotesize $y$ is fresh}}{\Gx, \Labx \SEQ \labels{x}{\BOX A}}{\Gx, x \rel y, \Labx \SEQ \labels{y}{A}}
			$
			\\[1ex]
			$
			\vlinf{\llabrn\DIA}{\text{\footnotesize $y$ is fresh}}{\Gx, \Labx, \labels{x}{\DIA A} \SEQ \labels{z}{B}}{\Gx, x \rel y, \Labx, \labels{y}{A} \SEQ \labels{z}{B}}
			\quad
			\vlinf{\rlabrn\DIA}{}{\Gx, x \rel y, \Labx \SEQ \labels{x}{\DIA A}}{\Gx, x \rel y, \Labx \SEQ \labels{y}{A}}
			$
		\end{minipage}
	}
	\caption{System $\lab\IK$}
	\label{fig:labIK}
\end{figure}

\begin{proposition}
	\hbox{}\quad
	\begin{enumerate}
		\item\label{StoM-form} If there is a proof $\vlderivation{\vlhtr{\DD}{\SEQ \labels{z}{C}}}$ in $\lab\IK$ then there is a proof $\vlderivation{\vlhtr{\DD_m}{\SEQ \labels{z}{C}}}$ in $\lab\heartsuit\IK$.
		
		\item\label{MtoS-form} If there is a proof $\vlderivation{\vlhtr{\DD}{\SEQ \labels{z}{C}}}$ in $\lab\heartsuit\IK$ then there is a proof $\vlderivation{\vlhtr{\DD_s}{\SEQ \labels{z}{C}}}$ in $\lab\IK$.
	\end{enumerate}
\end{proposition}

\begin{proof}
	\ref{StoM-form} by soudness of $\lab\IK$ wrt $\IK$ and completeness of $\lab\heartsuit\IK$ wrt $\IK$.
	\ref{MtoS-form} by soudness of $\lab\heartsuit\IK$ wrt $\IK$ and completeness of $\lab\IK$ wrt $\IK$.
\end{proof}

\begin{question}
	Can we give a direct proof of this result by proof transformation? In which case we might need to generalise the statement to make it suitable for an induction.

	\begin{enumerate}
		\item\label{StoM-seq} If there is a proof $\vlderivation{\vlhtr{\DD}{\Gx, \Labx \SEQ \labels{z}{C}}}$ in $\lab\IK$ then there is a proof $\vlderivation{\vlhtr{\DD^\rn{m}}{\Gx, \Labx \SEQ \labels{z}{C}}}$ in $\lab\heartsuit\IK$.
		
		\item\label{MtoS-seq} If there is a proof $\vlderivation{\vlhtr{\DD}{\Bx, \Labx \SEQ \Rabx}}$ in $\lab\heartsuit\IK$ then there is a proof $\vlderivation{\vlhtr{\DD^\rn{s}}{\Gx, \Labx \SEQ \labels{z}{C}}}$ in $\lab\IK$.
		%
		\todo{for which $\Gx$, which $z$ and which $C$?}
	\end{enumerate}
\end{question}

\begin{proof}
	\ref{StoM-seq} by case analysis on the last rule in $\DD$. 
	%
	Most of the rules in $\lab\IK$ are the same as rules in $\lab\heartsuit\IK$ except for the following:
	%
	\begin{smallalign*}
		\vlderibase{\labrn{id}}{}{\Gx, \Labx, \labels{x}{a} \SEQ \labels{x}{a}}{
			\vlhy{}
			}
		\reducesto&
		\vlderibase{refl}{}{\Gx, \Labx, \labels{x}{a} \SEQ \labels{x}{a}}{
			\vlin{\labrn{id}}{}{\Gx, x \le x, \Labx, \labels{x}{a} \SEQ \labels{x}{a}}{
				\vlhy{}
				}
			}
	\\
		\vlderibase{\rlabrn[1]\OR}{}{\Gx, \Labx \SEQ \labels{x}{A \OR B}}{
				\vlhtr{\DD_1}{\Gx, \Labx \SEQ \labels{x}{A}}
				}
		\quad\text{or}\quad
		\vlderibase{\rlabrn[2]\OR}{}{\Gx, \Labx \SEQ \labels{x}{A \OR B}}{
			\vlhtr{\DD_1}{\Gx, \Labx \SEQ \labels{x}{B}}
		}
		\reducesto&
		\vlderibase{\rlabrn\OR}{}{\Gx, \Labx \SEQ \labels{x}{A \OR B}}{
				\vlhtr{\DD_1^\rn{mw}}{\Gx, \Labx \SEQ \labels{x}{A}, \labels{x}{B}}
				}
	\\
		\vlderiibase{\llabrn\IMP}{}{\Gx, \Labx, \labels{x}{A \IMP B} \SEQ \labels{z}{C}}{
				\vlhtr{\DD_1}{\Gx, \Labx \SEQ \labels{x}{A}}
				}{
				\vlhtr{\DD_2}{\Gx, \Labx, \labels{x}{B} \SEQ \labels{z}{C}}
				}
		\reducesto&
		\vlderibase{refl}{}{\Gx, \Labx, \labels{x}{A \IMP B} \SEQ \labels{z}{C}}{
				\vliin{\llabrn\IMP}{}{\Gx, x \le x, \Labx, \labels{x}{A \IMP B} \SEQ \labels{z}{C}}{
					\vlhtr{\DD_1^\rn{mw}}{\Gx, x \le x, \Labx, \labels{x}{A \IMP B} \SEQ \labels{x}{A}}
					}{
					\vlhtr{\DD_2^\rn{mw}}{\Gx, x \le x, \Labx, \labels{x}{B} \SEQ \labels{z}{C}}
					}
				}
%	\end{smallequation*}
	\\
%	\begin{smallequation*}
		\vlderibase{\rlabrn\IMP}{}{\Gx, \Labx \SEQ \labels{x}{A \IMP B}}{
				\vlhtr{\DD_1}{\Gx, \Labx, \labels{x}{A} \SEQ \labels{x}{B}}
				}
		\reducesto&
		\vlderibase{\rlabrn\IMP}{}{\Gx, \Labx \SEQ \labels{x}{A \IMP B}}{
				\vlhtr{\DD_1^\rn{mw}}{\Gx, x \le x, \Labx, \labels{x}{A} \SEQ \labels{x}{B}}
			}
%	\end{smallequation*}
	\\
%	\begin{smallequation*}
		\vlderibase{\llabrn\BOX}{}{\Gx, x \rel y, \Labx, \labels{x}{\BOX A} \SEQ \labels{z}{B}}{
				\vlhtr{\DD_1}{\Gx, x \rel y, \Labx, \labels{x}{\BOX A}, \labels{y}{A} \SEQ \labels{z}{B}}
				}
		\reducesto&
		\vlderibase{refl}{}{\Gx, x \rel y, \Labx, \labels{x}{\BOX A} \SEQ \labels{z}{B}}{
				\vlin{\llabrn\BOX}{}{\Gx, x \le x, x \rel y, \Labx, \labels{x}{\BOX A} \SEQ \labels{z}{B}}{
					\vlhtr{\DD_1^\rn{mw}}{\Gx, x \le x, x \rel y, \Labx, \labels{x}{\BOX A}, \labels{y}{A} \SEQ \labels{z}{B}}
					}
				}
%	\end{smallequation*}
	\\
%	\begin{smallalign*}
		\vlderibase{\rlabrn\BOX}{}{\Gx, \Labx \SEQ \labels{x}{\BOX A}}{
				\vlhtr{\DD_1}{\Gx, x \rel y, \Labx \SEQ \labels{y}{A}}
				}
		\reducesto&
		\vlderibase{\rlabrn\BOX}{}{\Gx, \Labx \SEQ \labels{x}{\BOX A}}{
				\vlhtr{\DD_1^\rn{mw}}{\Gx, x \le x, x \rel y, \Labx \SEQ \labels{y}{A}}
				}
		\qedhere
%	\\
%		\vlderivation{
%			\vlin{\llabrn\DIA}{}{\Gx, \Labx, \labels{x}{\DIA A} \SEQ \labels{z}{B}}{
%				\vlhtr{\DD_1}{\Gx, x \rel y, \Labx, \labels{y}{A} \SEQ \labels{z}{B}}
%				}
%			}
%		\reducesto&
%		\vlderivation{	
%			\vlin{\llabrn\DIA}{}{\Gx, \Labx, \labels{x}{\DIA A} \SEQ \labels{z}{B}}{
%				\vlhtr{\DD_1^\rn{m}}{\Gx, x \rel y, \Labx, \labels{y}{A} \SEQ \labels{z}{B}}
%				}
%			}
	\end{smallalign*}
\end{proof}

\subsection{Extensions with Scott-Lemmon axioms}

Proof of $\ax{4_{\BOX}} \colon \BOX A \IMP \BOX\BOX A$

$\vlderivation{
	\vlin{\rlabrn\IMP}{}{\labels{x}{\BOX A \IMP \BOX\BOX A}}{	
		\vliq{\rlabrn\BOX}{}{x \le w, \labels{w}{\BOX A} \SEQ \labels{w}{\BOX\BOX A}}{
			\vlin{\rn{F_1}}{}{x \le w, w \le w', \bm{w' \rel v}, \bm{v \le v'}, v' \rel u, \labels{w}{\BOX A} \SEQ \labels{u}{A}}{
				\vlin{\rn{trans}}{}{x \le w, w \le w', w' \rel v, v \le v', v' \rel u, \bm{w' \le t}, \bm{t \rel v'}, \labels{w}{\BOX A} \SEQ \labels{u}{A}}{
					\vlin{\boxbrn{4}}{}{x \le w, w \le w', w' \rel v, v \le v', \bm{v' \rel u}, w' \le t, \bm{t \rel v'}, w \le t \labels{w}{\BOX A} \SEQ \labels{u}{A}}{
						\vlin{\labrn\BOX}{}{x \le w, w \le w', w' \rel v, v \le v', v' \rel u, w' \le t, t \rel v', w \le t, \bm{t \rel u}, \labels{w}{\BOX A} \SEQ \labels{u}{A}}{
							\vlin{\labrn{id}}{}{x \le w, w \le w', w' \rel v, v \le v', v' \rel u, w' \le t, t \rel v', w \le t, t \rel u, \labels{w}{\BOX A}, \labels{u}{\A} \SEQ \labels{u}{A}}{
								\vlhy{}
								}
							}
						}
					}
				}
			}
		}
	}
$

Proof of $\ax{4_{\DIA}} \colon \DIA\DIA A \IMP \DIA A$:

$\vlderivation{
	\vlin{\rlabrn\IMP}{}{\labels{x}{\DIA\DIA A \IMP \DIA A}}{
		\vliq{\llabrn\DIA}{}{x \le w, \labels{w}{\DIA\DIA A} \SEQ \labels{w}{\DIA A}}{
			\vlin{\diasym_\rn{4}}{}{x \le w, w \rel v, v \rel u, \labels{u}{A} \SEQ \labels{w}{\DIA A}}{
				\vlin{\rlabrn\DIA}{}{x \le w, w \rel v, v \rel u, u \le u', w \rel u'  \labels{u}{A} \SEQ \labels{w}{\DIA A}}{
					\vlin{\labrn{id}}{}{x \le w, w \rel v, v \rel u, u \le u', w \rel u'  \labels{u}{A} \SEQ \labels{w}{\DIA A}, \labels{u'}{A}}{
						\vlhy{}
						}
					}
				}
			}
		}
	}
$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Constructive modal logic(s?)}

%\subsection{Syntax}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Semantics}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Labelled proof theory}
%
%\begin{figure}
%	\small
%	\fbox{
%		\begin{minipage}{.95\textwidth}
%			\centering
%			$
%			\vlinf{\labrn{id}}{}{\Bx, x \le y, \Labx, \labels{x}{a} \SEQ \Rabx, \labels{y}{a}}{}
%			\quad
%%			\vlinf{\rlabrn\TOP}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{\TOP}}{}
%%			$
%%			\\
%%			$
%%			\vlinf{\llabrn\BOT}{}{\Bx, \Labx, \labels{x}{\BOT} \SEQ \Rabx}{}
%%			\quad
%			\vlinf{\rlabrn\BOT}{}{\BBot, x; \Bx, \Labx \SEQ \Rabx, \labels{x}{\BOT}}{}
%			$
%			\\[1ex]
%			$
%			\vlinf{\llabrn\AND}{}{\Bx, \Labx, \labels{x}{A \AND B} \SEQ \Rabx}{\Bx, \Labx, , \labels{x}{A}, \labels{x}{B} \SEQ \Rabx}
%			\quad
%			\vliinf{\rlabrn\AND}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \AND B}}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A}}{\Bx \SEQ \Rabx, \labels{x}{B}}
%			$
%			\\[1ex]
%			$
%			\vliinf{\llabrn\OR}{}{\Bx, \Labx, \labels{x}{A \OR B} \SEQ \Rabx}{\Bx, \Labx, \labels{x}{A} \SEQ \Rabx}{\Bx, \Labx, \labels{x}{B} \SEQ \Rabx}
%			\quad
%			\vlinf{\rlabrn[1]\OR}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \OR B}}{\Bx \SEQ \Rabx, \labels{x}{A}}
%			\quad
%			\vlinf{\rlabrn[2]\OR}{}{\Bx, \Labx \SEQ \Rabx, \labels{x}{A \OR B}}{\Bx \SEQ \Rabx, \labels{x}{B}}
%			$
%			\\[1ex]
%			$
%			\vlinf{\llabrn\BOX}{}{\Bx, x \le x', x' \rel y', \Labx, \labels{x}{\BOX A} \SEQ \Rabx}{\Bx, x \le x', x' \rel y', \Labx, \labels{x}{\BOX A}, \labels{y'}{A} \SEQ \Rabx}
%			\quad
%			\vlinf{\rlabrn\BOX}{\text{\footnotesize $x',y'$ fresh}}{\Bx \SEQ \Rabx, \labels{x}{\BOX A}}{\Bx, x \le x', x' \rel y' \SEQ \Rabx, \labels{x}{\BOX A}, \labels{y'}{A}}
%			$
%			\\[1ex]
%			$
%			\vlinf{\llabrn\DIA}{}{\Bx \Labx, \labels{x}{\DIA A} \SEQ \Rabx}{\Bx, x \rel y, \Labx, \labels{x}{\DIA A}, \labels{y}{A} \SEQ \Rabx}
%			\quad				
%			\vlinf{\rlabrn\DIA}{}{\Bx, x \rel y \SEQ \Rabx, \labels{x}{\DIA A}}{\Bx, x \rel y \SEQ \Rabx, \labels{x}{\DIA A}, \labels{y}{A}}
%			$
%			\\[1ex]
%			$\mbox{\hbox to .95\linewidth{\dotfill}}$
%			\\[1ex]
%			$
%			\vlinf{}{}{\BBot, x; \Bx, x \rel y, \Labx \SEQ \Rabx}{\BBot, x, y; \Bx, x \rel y, \Labx \SEQ \Rabx}
%			\quad
%			\vlinf{}{}{\BBot, x; \Bx, x \le y, \Labx \SEQ \Rabx}{\BBot, x, y; \Bx, x \le y, \Labx \SEQ \Rabx}
%			$
%			\\[1ex]
%			$
%			\vlinf{}{}{\Bx, \Labx \SEQ \Rabx}{\Bx, x \le x, \Labx \SEQ \Rabx}
%			\quad
%			\vlinf{}{}{\Bx, x \le y, y \le z, \Labx \SEQ \Rabx}{\Bx, x \le y, y \le z, x \le z, \Labx \SEQ \Rabx}
%			$
%		\end{minipage}
%	}
%	\caption{System $\lab\heartsuit\CK$}
%	\label{fig:labhCK}
%\end{figure}

\subsection{Sequent system}

\[
\vlinf{\rn{id}}{}{\Gamma, A \SEQ \Delta, A}{}
\quad
\vlinf{\lrn\BOT}{}{\Gamma, \BOT \SEQ \Delta}{}
\quad
\vlinf{\rrn\BOT}{}{\Gamma \SEQ \Delta, \BOT}{\Gamma \SEQ \Delta}
\]
\[
\vliinf{\lrn\OR}{}{\Gamma, A \OR B \SEQ \Delta}{\Gamma, A \SEQ \Delta}{\Gamma, B \SEQ \Delta}
\quad
\vlinf{\rrn\OR}{}{\Gamma \SEQ \Delta, A \OR B}{\Gamma \SEQ \Delta, A, B}
\quad
\vlinf{\lrn\AND}{}{\Gamma, A \AND B \SEQ \Delta}{\Gamma, A, B \SEQ \Delta}
\quad
\vliinf{\rrn\AND}{}{\Gamma \SEQ \Delta, A \AND B}{\Gamma \SEQ \Delta, A}{\Gamma \SEQ \Delta, B}
\]
\[
\vliinf{\lrn\IMP}{}{\Gamma, A \IMP B \SEQ \Delta}{\Gamma, A \IMP B \SEQ \Delta, A}{\Gamma, B \SEQ \Delta}
\quad
\vlinf{\rrn\IMP}{}{\Gamma \SEQ \Delta, A \IMP B}{\Gamma \SEQ A \IMP B}
\]
\[
\vlinf{\lrn\DIA}{}{\BOX\Gamma_1, \Gamma_2, \DIA A \SEQ \DIA\Delta_1, \Delta_2}{\Gamma_1, A \SEQ \Delta_1}
\quad
\vlinf{\rrn\BOX}{}{\BOX\Gamma_1, \Gamma_2 \SEQ \Delta, \BOX A}{\Gamma_1 \SEQ A}
\]

\subsection{Remarks}

We know that $\kax[1]$ and $\kax[2]$ are easily derived even if we restrict the succedent to always be a singleton.
\[\vlderivation{
	\vlin{\rrn\IMP}{}{\kax[1]\colon\BOX(A \IMP B) \IMP (\BOX A \IMP \BOX B)}{
		\vlin{\rrn\IMP}{}{\BOX(A \IMP B) \SEQ \BOX A \IMP \BOX B}{
			\vlin{\rrn\BOX}{}{\BOX(A \IMP B), \BOX A \SEQ \BOX B}{
				\vliin{\lrn\IMP}{}{A \IMP B, A \SEQ B}{
					\vlin{\rn{id}}{}{A \IMP B, A \SEQ A}{
						\vlhy{}
						}
					}{
					\vlin{\rn{id}}{}{B, A \SEQ B}{
						\vlhy{}
						}
					}
				}
			}
		}
	}
\qquad
\vlderivation{
	\vlin{\rrn\IMP}{}{\kax[2]\colon\BOX(A \IMP B) \IMP(\DIA A \IMP \DIA B)}{
		\vlin{\rrn\IMP}{}{\BOX(A \IMP B) \SEQ \DIA A \IMP \DIA B}{
			\vlin{\lrn\DIA}{}{\BOX(A \IMP B), \DIA A \SEQ \DIA B}{
				\vliin{\lrn\IMP}{}{A \IMP B, A \SEQ B}{
					\vlin{\rn{id}}{}{A \IMP B, A \SEQ A}{
						\vlhy{}
						}
					}{
					\vlin{\rn{id}}{}{B, A \SEQ B}{
						\vlhy{}
						}
					}
				}
			}
		}
	}
\]

$\kax[3]$ becomes derivable as soon as we allow two or more formulas on the right.
\[
\vlderivation{
	\vlin{\rrn\IMP}{}{\kax[3]\colon\DIA(A \OR B)\IMP(\DIA A \OR \DIA B)}{
		\vlin{\rrn\OR}{}{\DIA(A \OR B) \SEQ \DIA A \OR \DIA B}{
			\vlin{\lrn\DIA}{}{\DIA(A \OR B) \SEQ \DIA A, \DIA B}{
				\vliin{\lrn\OR}{}{A \OR B \SEQ A, B}{
					\vlin{\rn{id}}{}{A \SEQ A, B}{
						\vlhy{}
						}
					}{
					\vlin{\rn{id}}{}{B \SEQ A, B}{
						\vlhy{}
						}
					}
				}
			}
		}
	}
\]

$\kax[5]$ becomes derivable as soon as we allow the righthandside to be empty. 
\[
\vlderivation{
	\vlin{\rrn\IMP}{}{\kax[5]\colon\DIA\BOT\IMP\BOT}{
		\vlin{\rrn\BOT}{}{\DIA\BOT \SEQ \BOT}{
			\vlin{\lrn\DIA}{}{\DIA\BOT \SEQ}{
				\vlin{\lrn\BOT}{}{\BOT \SEQ}{
					\vlhy{}
					}
				}
			}
		}
	}
\]

$\kax[4]$ on the other hand, is still underivable.
\[
\vlderivation{
	\vlin{\rrn\IMP}{}{\kax[4]\colon(\DIA A \IMP \BOX B)\IMP\BOX(A \IMP B)}{
		\vliin{\lrn\IMP}{}{\DIA A \IMP \BOX B \SEQ \BOX(A \IMP B)}{
			\vlin{\textcolor{red}{?}}{}{\DIA A \IMP \BOX B \SEQ \DIA A, \BOX(A \IMP B)}{
				\vlhy{\textcolor{red}{???}}
				}
			}{
			\vlin{\rrn\BOX}{}{\BOX B \SEQ \BOX(A \IMP B)}{
				\vlin{\rrn\IMP}{}{B \SEQ A \IMP B}{
					\vlin{\rn{id}}{}{B, A \SEQ B}{
						\vlhy{}
						}
					}
				}
			}
		}
	}
\]

\subsection{Bicolor nested sequent systems}

\paragraph{For $\IK$}
\[
\vlinf{\rn{id}}{}{\Cx[1]{\lf A, \bBR{\rt A, \Cx[2]}}}{}
\quad
\vlinf{\lrn{\BOT}}{}{\Cx{\lf \BOT}}{}
\]
\[
\vlinf{\lrn\AND}{}{\Cx{\lf{A \AND B}}}{\Cx{\lf A, \lf B}}
\quad
\vliinf{\rrn\AND}{}{\Cx{\rt{A \AND B}}}{\Cx{\rt A}}{\Cx{\rt B}}
\quad
\vliinf{\lrn\OR}{}{\Cx{\lf{A \OR B}}}{\Cx{\lf A}}{\Cx{\lf B}}
\quad
\vlinf{\rrn\OR}{}{\Cx{\rt{A \OR B}}}{\Cx{\rt A, \rt B}}
\]
\[
%\vliinf{\lrn\IMP}{}{\Cx[1]{\lf{A \IMP B}, \bBR{\Cx[2]}}}{\Cx[1]{\lf{A \IMP B}, \bBR{\rt A, \Cx[2]}}}{\Cx[1]{\bBR{\lf B, \Cx[2]}}}
%
\vliinf{\lrn[1]\IMP}{}{\Cx[1]{\lf{A \IMP B}}}{\Cx[1]{\rt A}}{\Cx[1]{\lf B}}
\quad
\vlinf{\lrn[2]\IMP}{}{\Cx[1]{\lf{A \IMP B}, \bBR{\Cx[2]}}}{\Cx[1]{\bBR{\lf{A \IMP B}, \Cx[2]}}}
\quad
\vlinf{\rrn\IMP}{}{\Cx{\rt{A \IMP B}}}{\Cx{\bBR{\lf A, \rt B}}}
\]
\[
\vlinf{\lrn\BOX}{}{\Cx[1]{\lf{\BOX A}, \bBR{\BR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\lf A, \Cx[2]}}}}
\quad
\vlinf{\rrn\BOX}{}{\Cx{\rt{\BOX A}}}{\Cx{\bBR{\BR{\rt A}}}}
\quad
\vlinf{\lrn\DIA}{}{\Cx{\lf{\DIA A}}}{\Cx{\BR{\lf A}}}
\quad
\vlinf{\rrn\DIA}{}{\Cx[1]{\rt{\DIA A}, \BR{\Cx[2]}}}{\Cx[1]{\BR{\rt A, \Cx[2]}}}
\]
\[
\vlinf{\lrn{mon}}{}{\Cx[1]{\lf A, \bBR{\Cx[2]}}}{\Cx[1]{\bBR{\lf A, \Cx[2]}}}
\quad
\vlinf{\rrn{mon}}{}{\Cx[1]{\bBR{\rt An, \Cx[2]}}}{\Cx51]{\rt A, \bBR{\Cx[2]}}}
\quad
\vlinf{\rn{F_1}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\Cx[2]}}}}
\]

\paragraph{For $\sys{IS4}$}
Replace $\lrn\BOX$ and $\rrn\DIA$ above by the following:
\[
\vlinf{\lrn[1]\BOX}{}{\Cx[1]{\lf{\BOX A}}}{\Cx{\lf A}}
\quad
\vlinf{\lrn[2]\BOX}{}{\Cx[1]{\lf{\BOX A}, \bBR{\BR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\lf{\BOX A}, \Cx[2]}}}}
\quad
\vlinf{\rrn[1]\DIA}{}{\Cx[1]{\rt{\DIA A}}}{\Cx{\rt A}}
\quad
\vlinf{\rrn[2]\DIA}{}{\Cx[1]{\rt{\DIA A}, \BR{\Cx[2]}}}{\Cx[1]{\BR{\rt{\DIA A}, \Cx[2]}}}
\]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Bibliography
\bibliographystyle{plain}
\bibliography{references}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}