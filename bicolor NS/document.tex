\documentclass{article}


\newcommand{\todo}[1]{\textcolor{red}{TODO: #1}}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\blue}[1]{{\color{blue}{#1}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Packages
\usepackage{geometry}
\geometry{vmargin=3.2cm,hmargin=3.5cm}%
\usepackage{rotating}

\usepackage{amsmath} % for improving the structure and printed output of documents containing mathematical formulas
\usepackage{amssymb} % for mathematical symbols and fonts
\usepackage{bm} % command \bm makes its ar­gu­ment bold, better than \boldsymbol{}
\usepackage{colonequals} % symbols := and ::=
%\usepackage{cmll}  % Linear Logic symbols

\usepackage{wasysym} % for smiley 
\renewcommand\qedsymbol{$\smiley$}

\usepackage{graphicx} % for graphics, and commands like \scalebox{h-scale}{text} in particular
\usepackage[matrix,arrow]{xy}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}%[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{question}[theorem]{Question}
\newtheorem{conjecture}[theorem]{Conjecture}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Proof package
\usepackage[noxy]{virginialake}
\vlnosmallleftlabels
\vlnostructuressyntax
%
\newcommand{\marianela}[1]{{\color{purple}[Marianela: #1]}}
\newcommand{\sonia}[1]{{\color{blue}[Sonia: #1]}}

\newcommand{\vlhtr}[2]{\vlpd{#1}{}{#2}}
%
\newcommand{\vlderivationauxnc}[1]{#1{\box\derboxone}\vlderivationterm}
\newcommand{\vlderivationnc}{\vlderivationinit\vlderivationauxnc}
%
%
\makeatletter
\newbox\@conclbox
\newdimen\@conclheight
%
\newcommand\vlderibase[4]{{%
		\setbox\@conclbox=\hbox{$#3$}\relax%
		\@conclheight=\ht\@conclbox%
		\setbox\@conclbox=\hbox{$%
			\vlderivationnc{%
				\vlin{#1}{#2}{\box\@conclbox}{#4}%
			}$}%
		\lower\@conclheight\box\@conclbox%
	}}
	%
	\newcommand\vlderidbase[4]{{%
			\setbox\@conclbox=\hbox{$#3$}\relax%
			\@conclheight=\ht\@conclbox%
			\setbox\@conclbox=\hbox{$%
				\vlderivationnc{%
					\vlid{#1}{#2}{\box\@conclbox}{#4}%
				}$}%
			\lower\@conclheight\box\@conclbox%
		}}
		%
		\newcommand\vlderiibase[5]{{%
				\setbox\@conclbox=\hbox{$#3$}\relax%
				\@conclheight=\ht\@conclbox%
				\setbox\@conclbox=\hbox{$%
					\vlderivationnc{%
						\vliin{#1}{#2}{\box\@conclbox}{#4}{#5}%
					}$}%
				\lower\@conclheight\box\@conclbox%
			}}
			\makeatother
			%
			
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
			%%% Equation environments
			\newdimen\mydisplayskip
			\mydisplayskip=.4\abovedisplayskip
			\newenvironment{smallequation}
			{\par\nobreak\vskip\mydisplayskip\noindent\bgroup\small\csname equation\endcsname}{\csname endequation\endcsname\egroup}
			\newenvironment{smallequation*}
			{\par\nobreak\vskip\mydisplayskip\noindent\bgroup\small\csname equation*\endcsname}{\csname endequation*\endcsname\egroup}
			\newenvironment{smallalign}
			{\par\nobreak\noindent\bgroup\small\csname align\endcsname}{\csname endalign\endcsname\egroup}
			\newenvironment{smallalign*}
			{\par\nobreak\noindent\bgroup\small\csname align*\endcsname}{\csname endalign*\endcsname\egroup}
			%\newenvironment{smallmultline}
			%{\par\nobreak\vskipmydisplayskip\noindent\bgroup\small\csname multline*\endcsname}{\csname endmultline*\endcsname\egroup}
			
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Extracting symbols from MnSymbol 
\DeclareFontFamily{U} {MnSymbolC}{}

\DeclareFontShape{U}{MnSymbolC}{m}{n}{
<-6>  MnSymbolC5
<6-7>  MnSymbolC6
<7-8>  MnSymbolC7
<8-9>  MnSymbolC8
<9-10> MnSymbolC9
<10-12> MnSymbolC10
<12->   MnSymbolC12}{}
\DeclareFontShape{U}{MnSymbolC}{b}{n}{
<-6>  MnSymbolC-Bold5
<6-7>  MnSymbolC-Bold6
<7-8>  MnSymbolC-Bold7
<8-9>  MnSymbolC-Bold8
<9-10> MnSymbolC-Bold9
<10-12> MnSymbolC-Bold10
<12->   MnSymbolC-Bold12}{}

\DeclareSymbolFont{MnSyC}         {U}  {MnSymbolC}{m}{n}

%\DeclareMathSymbol{\triangleright}{\mathbin}{MnSyC}{80}
\DeclareMathSymbol{\diamondplus}{\mathbin}{MnSyC}{124}
\DeclareMathSymbol{\boxtimes}{\mathbin}{MnSyC}{117}
\DeclareMathSymbol{\meddiamond}{\mathbin}{MnSyC}{110}
\DeclareMathSymbol{\medsquare}{\mathbin}{MnSyC}{106}
\DeclareMathSymbol{\vee}{\mathbin}{MnSyC}{45}
\DeclareMathSymbol{\wedge}{\mathbin}{MnSyC}{44}
\DeclareMathSymbol{\bot}{\mathbin}{MnSyC}{150}
\DeclareMathSymbol{\top}{\mathbin}{MnSyC}{151}
%\DeclareMathSymbol{\forall}{\mathbin}{MnSyC}{166}
%\DeclareMathSymbol{\exists}{\mathbin}{MnSyC}{167}
%\DeclareMathSymbol{\smalldiamond}{\mathbin}{MnSyC}{108}
%\DeclareMathSymbol{\filleddiamond}{\mathbin}{MnSyC}{109}	 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% General maths
\newcommand*\mdelim[3]{%
\mathopen{}\left#1%
#3%
\right#2\mathclose{}%
}

\newcommand*{\tuple}{\mdelim{\langle}{\rangle}}

\newcommand*{\DD}{\mathcal{D}}

\newcommand*{\reducesto}{\quad{\leadsto}\quad}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Connectives
\newcommand*{\NEG}[1]{\bar{#1}}
\newcommand*{\NOT}{\neg}
\newcommand*{\AND}{\mathbin{\scalebox{.85}{\raise.1ex\hbox{\large$\wedge$}}}}
\newcommand*{\TOP}{\mathord{\top}}
\newcommand*{\OR}{\mathbin{\scalebox{.85}{\raise.1ex\hbox{\large$\vee$}}}}
\newcommand*{\BOT}{\mathord{\bot}}
\newcommand*{\IMP}{\mathbin{\scalebox{.6}{\raise.4ex\hbox{\large$\bm\supset$}}}}%\supset}}%

\newcommand*{\BOX}{\mathord{\medsquare}}
\newcommand*{\DIA}{\mathord{\scalebox{.9}{\raise.1ex\hbox{$\meddiamond$}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Logic
\newcommand*{\ax}[1]{\mathsf{#1}}
\newcommand*{\kax}[1][]		{\ax{k_{#1}}}

\newcommand*{\A}{\mathcal{A}}
\newcommand*{\F}{\mathcal{F}}
\newcommand*{\M}{\mathfrak{M}}

\newcommand{\force}[2]{#1\Vdash#2}
\newcommand{\nforce}[2]{#1\nVdash#2}
%
\newcommand{\height}[1]{|#1|}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Systems
\newcommand*{\sys}[1]{\ensuremath{\mathsf{#1}}}%\xspace}
\newcommand*{\K}{\sys{K}}
\newcommand*{\IK}{\sys{IK}}
\newcommand*{\CK}{\sys{CK}}

\newcommand*{\lab}{\mathsf{lab}}
\newcommand*{\labK}{\lab\K}

%%%% System NKK
\newcommand{\IMPW}{\IMP^{\circ}}
\newcommand{\IMPB}{\IMP^{\bullet}}
\newcommand{\ANDW}{\AND^{\circ}}
\newcommand{\ANDB}{\AND^{\bullet}}
\newcommand{\ORW}{\OR^{\circ}}
\newcommand{\ORB}{\OR^{\bullet}}
\newcommand{\BOXW}{\BOX^{\circ}}
\newcommand{\BOXB}{\BOX^{\bullet}}
\newcommand{\DIAW}{\DIA^{\circ}}
\newcommand{\DIAB}{\DIA^{\bullet}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Labelled sequents
\newcommand{\SEQ}{\Rightarrow}

\newcommand*{\Labx}{\mathcal{L}}
\newcommand*{\Rabx}{\mathcal{R}}
\newcommand*{\Gx}{\mathcal{G}}
\newcommand*{\Bx}{\mathcal{B}}
\newcommand*{\labels}[2]{{\color{blue}{#1}\:\colon}{#2}}
\newcommand*{\rel}{R}

\newcommand*{\BBot}{\Perp} % \usepackage{cmll} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Rules
\newcommand*{\rn}[1]  {\ensuremath{\mathsf{#1}}}
\newcommand*{\invr}[1]{#1^\mathsf{inv}}
%
\newcommand*{\orn}[2][]  {\rn{#2}_{#1}}%^{\lab}}}
\newcommand*{\rrn}[2][]  {\rn{#2}_\rn{R#1}}%^\lab}}
\newcommand*{\lrn}[2][]  {\rn{#2}_\rn{L#1}}%^\lab}}
%
\newcommand*{\labrn}[2][]  {\rn{#2}_{#1}}%^{\lab}}}
%\newcommand*{\rlabrn}[2][]  {\rn{#2}_\rn{R#1}}%^\lab}}
%\newcommand*{\llabrn}[2][]  {\rn{#2}_\rn{L#1}}%^\lab}}

\newcommand*{\brsym}{\mathord{\scalebox{.9}{$\boxtimes$}}}
\newcommand*{\boxbrn}[1]{\rn{\brsym_\rn{#1}}}%^{\lab}}}
\newcommand*{\diasym}{\mathord{\diamondplus}}
\newcommand*{\diabrn}[1][]{\rn{\diasym_\rn{#1}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Nested sequents
\makeatletter
%\newcommand*\BR[2][]{\mdelim{\lbrack\strut^{#1}}{\rbrack}{#2}}
\newcommand*{\BR}{%
\@ifnextchar\i{\br@two}{%
\@ifnextchar\bgroup{\br@one}{% 
}}}
\newcommand*{\br@one}[1]{%
\def\br@{#1}%
\mdelim{\lbrack}{\rbrack}{\ifx\br@\empty\mkern 3mu\else #1\fi}%
}
\newcommand*{\br@two}[3]{%
\def\br@{#3}%
\mdelim{\lbrack\strut^{#2}}{\rbrack}{\ifx\br@\empty\mkern 3mu\else #3\fi}%
}
%
\newcommand*{\bBR}{%
\@ifnextchar\i{\bbr@two}{%
\@ifnextchar\bgroup{\bbr@one}{% 
}}}
\newcommand*{\bbr@one}[1]{%
\def\br@{#1}%
\mdelim{\llbracket}{\rrbracket}{\ifx\br@\empty\mkern 3mu\else #1\fi}%
}
\newcommand*{\bbr@two}[3]{%
\def\br@{#3}%
\mdelim{\llbracket\strut^{#2}}{\rrbracket}{\ifx\br@\empty\mkern 3mu\else #3\fi}%
}
%
%\newcommand*{\@makeoperator}[2]{
%	\newcommand*{#1}{%
%		\mathrm{#2}\mdelim{\lparen}{\rparen}
%	}
%}
%%
%\@makeoperator{\fm}{fm^{\n}}
%\@makeoperator{\ofm}{fm^{\o}}
%\@makeoperator{\hfm}{fm^{\h}}
%%
%\@makeoperator{\depth}{dp}
%\@makeoperator{\rank}{rk}
%\@makeoperator{\height}{ht}
%\@makeoperator{\tree}{tree}
%\@makeoperator{\graph}{graph}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% contexts
\makeatletter
\newcommand*{\cxs}{%
\@ifnextchar\i{\cxs@two}{%
\@ifnextchar\bgroup{\cxs@one}{% % \bgroup is the same as {
}}}
\newcommand*{\cxs@one}[1]{%
	\def\cxs@{#1}%
	\mdelim{\lbrace}{\rbrace}{\ifx\cxs@\empty\mkern 3mu\else #1\fi}%
	\cxs@one@decor%
}
\newcommand*{\cxs@two}[3]{%
	\def\cxs@{#3}%
	\mdelim{\lbrace\strut^{#2}}{\rbrace}{\ifx\cxs@\empty\mkern 3mu\else #3\fi}%
	\cxs@one@decor%
}
\def\cxs@one@decor{%
	\@ifnextchar_{\cxs@one@sub}{%
		\@ifnextchar^{\cxs@one@sup}{%
			\@ifnextchar\dots{\@firstoftwo{\dotsm\cxs@one@decor}}{%
				\@ifnextchar[{\cxs@one@arg}%]
				\cxs}}}%
}
\def\cxs@one@sub_#1{_{#1}\cxs@one@decor}
\def\cxs@one@sup^#1{^{#1}\cxs@one@decor}
\def\cxs@one@arg[#1]{{#1}\cxs@one@decor}

%% Change these as needed, but keep the \cx@continuation at the end
\def\cx@delete@always#1{{#1}^{\ast}\cx@continuation}
\def\cx@delete@right#1*{{#1}^{\star}\cx@continuation}
\def\cx@delete@focus#1\f{{#1}^{\scriptscriptstyle\not{\langle}{\rangle}}\cx@continuation}

\def\cx@delete@star#1*{%
	\@ifnextchar*{\cx@delete@right{#1}}{\cx@delete@always{#1}}%
}

\newcommand*{\@makecontextual}[2]{
	\newcommand*{#1}{%
		\@ifnextchar*{\cx@delete@star{#2}}{%
			\@ifnextchar\f{\cx@delete@focus{#2}}{%
				#2\cx@continuation}}%
	}%
}
\newcommand*{\cx@continuation}[1][]{_{#1}\cxs}

\@makecontextual{\Ex}{}

\@makecontextual{\Cx}{\Gamma}
\@makecontextual{\Dx}{\Delta}
\@makecontextual{\Lx}{\Lambda}
\@makecontextual{\Rx}{\Pi}

\@makecontextual{\LLx}{\Omega}
\@makecontextual{\RRx}{\Xi}
\@makecontextual{\CCx}{\Sigma}
\@makecontextual{\DDx}{\Theta}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% intuitionistic
\newcommand*{\rt}[1]{#1^\circ}
\newcommand*{\lf}[1]{#1^\bullet}
\begin{document}

\section{Bicolor nested sequent systems}

\paragraph{For $\IK$}

\[
\vlinf{\rn{id}}{}{\Cx[1]{\lf A, \bBR{\rt A, \Cx[2]}}}{}
%\vlinf{\rn{id}}{}{\Cx{\lf A, \rt A}}{}
\quad
\vlinf{\lrn{\BOT}}{}{\Cx{\lf \BOT}}{}
\]
\[
\vlinf{\lrn\AND}{}{\Cx{\lf{A \AND B}}}{\Cx{\lf A, \lf B}}
\quad
\vliinf{\rrn\AND}{}{\Cx{\rt{A \AND B}}}{\Cx{\rt A}}{\Cx{\rt B}}
\quad
\vliinf{\lrn\OR}{}{\Cx{\lf{A \OR B}}}{\Cx{\lf A}}{\Cx{\lf B}}
\quad
\vlinf{\rrn\OR}{}{\Cx{\rt{A \OR B}}}{\Cx{\rt A, \rt B}}
\]
\[
%\vliinf{\lrn\IMP}{}{\Cx[1]{\lf{A \IMP B}, \bBR{\Cx[2]}}}{\Cx[1]{\lf{A \IMP B}, \bBR{\rt A, \Cx[2]}}}{\Cx[1]{\bBR{\lf B, \Cx[2]}}}
%
\vliinf{\lrn\IMP}{}{\Cx[1]{\lf{A \IMP B}}}{\Cx[1]{\lf{A \IMP B}, \rt A}}{\Cx[1]{\lf B}}
\quad
%\vlinf{\lrn[2]\IMP}{}{\Cx[1]{\lf{A \IMP B}, \bBR{\Cx[2]}}}{\Cx[1]{\bBR{\lf{A \IMP B}, \Cx[2]}}}
\quad
\vlinf{\rrn\IMP}{}{\Cx{\rt{A \IMP B}}}{\Cx{\bBR{\lf A, \rt B}}}
\]
\[
%\vlinf{\lrn\BOX}{}{\Cx[1]{\lf{\BOX A}, \bBR{\BR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\lf A, \Cx[2]}}}}
\vlinf{\lrn\BOX}{}{\Cx[1]{\lf{\BOX A}, \BR{\Cx[2]}}}{\Cx[1]{\lf{\BOX A}, \BR{\lf A, \Cx[2]}}}
\quad
\vlinf{\rrn\BOX}{}{\Cx{\rt{\BOX A}}}{\Cx{\bBR{\BR{\rt A}}}}
\quad
\vlinf{\lrn\DIA}{}{\Cx{\lf{\DIA A}}}{\Cx{\BR{\lf A}}}
\quad
\vlinf{\rrn\DIA}{}{\Cx[1]{\rt{\DIA A}, \BR{\Cx[2]}}}{\Cx[1]{\rt{\DIA A}, \BR{\rt A, \Cx[2]}}}
\]
\[
%\vlinf{\lrn{mon}}{}{\Cx[1]{\lf A, \bBR{\Cx[2]}}}{\Cx[1]{\bBR{\lf A, \Cx[2]}}}
\vlinf{\lrn{mon}}{}{\Cx[1]{\lf A, \bBR{\Cx[2]}}}{\Cx[1]{\lf A, \bBR{\lf A, \Cx[2]}}}
\quad
%\vlinf{\rn{F_1}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\Cx[2]}}}}
\vlinf{\rn{F_1}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{\Cx[1]{\BR{\bBR{\Cx[2]}}, \bBR{\BR{\Cx[2]}}}}
\]
\[\mbox{\hbox to .9\linewidth{\dotfill}}\]
\[
\vlinf{\rrn{mon}}{}{\Cx[1]{\bBR{\rt A, \Cx[2]}}}{\Cx[1]{\rt A, \bBR{\Cx[2]}}}
\quad
\vlinf{\rn{refl}_\le}{}{\Cx[1]{\Cx[2]}}{\Cx[1]{\bBR{\Cx[2]}}}
\quad
\vlinf{\rn{trans}_\le}{}{\Cx[1]{\bBR{\Cx[2], \bBR{\Cx[3]}}}}{\Cx[1]{\bBR{\Cx[2]}, \bBR{\Cx[3]}}}
\]


\paragraph{For $\sys{IS4}$}
Replace $\lrn\BOX$ and $\rrn\DIA$ above by the following:
\[
\vlinf{\lrn[1]\BOX}{}{\Cx{\lf{\BOX A}}}{\Cx{\lf{\BOX A}, \lf A}}
\quad
%\vlinf{\lrn[2]\BOX}{}{\Cx[1]{\lf{\BOX A}, \bBR{\BR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\lf{\BOX A}, \Cx[2]}}}}
\vlinf{\lrn[2]\BOX}{}{\Cx[1]{\lf{\BOX A}, \BR{\Cx[2]}}}{\Cx[1]{\lf{\BOX A}, \BR{\lf{\BOX A}, \Cx[2]}}}
\quad
\vlinf{\rrn[1]\DIA}{}{\Cx{\rt{\DIA A}}}{\Cx{\rt{\DIA A}, \rt A}}
\quad
\vlinf{\rrn[2]\DIA}{}{\Cx[1]{\rt{\DIA A}, \BR{\Cx[2]}}}{\Cx[1]{\rt{\DIA A}, \BR{\rt{\DIA A}, \Cx[2]}}}
\]
\[\mbox{\hbox to .9\linewidth{\dotfill}}\]
\[
\vlinf{\rn{t[]}}{}{\Cx[1]{\Cx[2]}}{\Cx[1]{\BR{\Cx[2]}}}
\qquad
\vlinf{\rn{4[]}}{}{\Cx[1]{\BR{\Cx[2], \BR{\Cx[3]}}}}{\Cx[1]{\BR{\Cx[2]}, \BR{\Cx[3]}}}
\]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Completeness}

%%%%%%%%%%%%%%%%%%%%k1%%%%%%%%%%%%%%%%%%
$$
\vlderivation{
		\vlin{\rrn\IMP}{}
		{\kax[1] \colon \rt{\BOX (A \IMP B) \IMP (\BOX A \IMP \BOX B)}}
		{\vlin {\rrn\IMP}{}
			{\bBR{\lf{\BOX(A \IMP B)}, \rt{\BOX A \IMP \BOX B}}}
			{\vlin {\rrn\BOX}{}
				{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX A}, \rt{\BOX B}}}}
				{\vlin {\lrn{mon}}{}
					{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX A}, \bBR{\BR{\rt{B}}}}}}
					{\vlin {\lrn\BOX}{}
						{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX A}, \bBR{\lf{\BOX A},\BR{\rt{B}}}}}}
						{\vlin {\lrn{mon}}{}
							{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX A}, \bBR{\lf{\BOX A}, \BR{\lf{A},\rt{B}}}}}}
							{\vlin {\lrn{mon}}{}
								{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX(A \IMP B)},\lf{\BOX A}, \bBR{\lf{\BOX A}, \BR{\lf{A},\rt{B}}}}}}
								{\vlin{\lrn\BOX}{}
									{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX(A \IMP B)},\lf{\BOX A}, \bBR{\lf{\BOX(A \IMP B)}, \lf{\BOX A}, \BR{\lf{A},\rt{B}}}}}}
									{\vliin{\lrn\IMP}{}
										{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX(A \IMP B)},\lf{\BOX A}, \bBR{\lf{\BOX(A \IMP B)}, \lf{\BOX A}, \BR{\lf{A \IMP B}, \lf{A},\rt{B}}}}}}
										{\vlin{\rn{refl}}{}
											{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\Bx, \bBR{\Bx, \BR{\lf{A \IMP B}, \rt{A}, \lf{A},\rt{B}}}}}}
											{\vlin{\rn{id}}{}
												{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\Bx, \bBR{\Bx, \BR{\lf{A \IMP B}, \bBR{\rt{A}}, \lf{A},\rt{B}}}}}}
												{\vlhy{}}}}
											{\vlin{\rn{refl}}{}
												{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\Bx, \bBR{\Bx, \BR{\lf{A},\rt{B}, \lf{B}}}}}}
												{\vlin{\rn{id}}{}
													{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\Bx, \bBR{\Bx, \BR{\lf{A},\bBR{\rt{B}}, \lf{B}}}}}}
													{\vlhy{}}}}}}}}}}}}}
$$

where $\Bx$ is equal to $\lf{\BOX(A \IMP B)}, \lf{\BOX A}$.
			
%%%%%%%%%%%%%%%%%%%%k2%%%%%%%%%%%%%%%%%%
	$$
	\vlderivation {
		\vlin{\rrn\IMP}
		{}
		{ \kax[2]\colon \rt{\BOX (A \IMP B) \IMP (\DIA A \IMP \DIA B)}}
		{\vlin {\rrn\IMP}
			{}
			{\bBR{\lf{\BOX (A \IMP B)}, \rt{\DIA A \IMP \DIA B}}}
			{\vlin {\lrn\DIA}
				{}
				{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\DIA A}, \rt{\DIA B}}}}
				{\vlin{\rrn\DIA}
					{}
					{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\BR{\lf{A}}, \rt{\DIA B}}}}
					{\vlin {\lrn{mon}}
						{}
						{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\BR{\lf{A}, \rt{B}}, \rt{\DIA B}}}}
						{\vlin {\lrn\BOX}
							{}
							{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\BOX (A \IMP B)}, \BR{\lf{A}, \rt{B}}, \rt{\DIA B}}}}
							{\vliin{\lrn\IMP}
								{}
								{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\BOX (A \IMP B)}, \BR{\lf{A \IMP B}, \lf{A}, \rt{B}}, \rt{\DIA B}}}}
								{\vlin{\rn{refl}}{}
									{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\BOX (A \IMP B)}, \BR{\lf{A\IMP B}, \rt{A}, \lf{A}, \rt{B}}, \rt{\DIA B}}}}
									{\vlin{\rn{id}}{}
										{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\BOX (A \IMP B)}, \BR{\lf{A\IMP B}, \bBR{\rt{A}}, \lf{A}, \rt{B}}, \rt{\DIA B}}}}
										{\vlhy{}}}}
								{\vlin{\rn{refl}}{}
									{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\BOX (A \IMP B)}, \BR{\lf{B}, \lf{A}, \rt{B}}, \rt{\DIA B}}}}
									{\vlin{\rn{id}}{}
										{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\BOX (A \IMP B)}, \BR{\lf{B}, \lf{A}, \bBR{\rt{B}}}, \rt{\DIA B}}}}
										{\vlhy{}}}}}}}}}}
	}
$$

%%%%%%%%%%%%%%%%%%%%k3%%%%%%%%%%%%%%%%%%
$$
\vlderivation {
		\vlin{\rrn\IMP}
		{}
		{\kax[3] \colon \rt{\DIA (A \OR B) \IMP (\DIA A \OR \DIA B)}}
		{\vlin {\lrn\DIA}
			{}
			{\bBR{\lf{\DIA (A \OR B)}, \rt{\DIA A \OR \DIA B}}}
			{\vlin{\rrn\OR}{}
				{\bBR{\BR{\lf{A \OR B}}, \rt{\DIA A \OR \DIA B}}}
				{\vliin{\lrn\OR}{}
					{\bBR{\BR{\lf{A \OR B}}, \rt{\DIA A}, \rt{\DIA B}}}
					{\vlin{\rrn\DIA}{}
						{\bBR{\BR{\lf{A}}, \rt{\DIA A}, \rt{\DIA B}}}
						{\vlin{\rn{refl}}{}
							{\bBR{\BR{\lf{A}, \rt{A}}, \rt{\DIA A}, \rt{\DIA B}}}
							{\vlin{\rn{id}}{}
								{\bBR{\BR{\lf{A}, \bBR{\rt{A}}}, \rt{\DIA A}, \rt{\DIA B}}}
								{\vlhy{}}}}}
					{\vlin{\rrn\DIA}{}
						{\bBR{\BR{\lf{B}}, \rt{\DIA A}, \rt{\DIA B}}}
						{\vlin{\rn{refl}}{}
							{\bBR{\BR{\lf{B}, \rt{B}}, \rt{\DIA A}, \rt{\DIA B}}}
							{\vlin{\rn{id}}{}
								{\bBR{\BR{\lf{B}, \bBR{\rt{B}}}, \rt{\DIA A}, \rt{\DIA B}}}
								{\vlhy{}}}}}}}}
	}
$$

%%%%%%%%%%%%%%%%%%%%k4%%%%%%%%%%%%%%%%%%
$$
\vlderivation {
\vlin{\rrn\IMP}
{}
{\kax[4] \colon \rt{(\DIA A \IMP \BOX B) \IMP \BOX(A \IMP B)}}
{\vlin {\rrn\BOX}
{}
{\bBR{\lf{\DIA A \IMP \BOX B}, \rt{\BOX(A \IMP B)}}}
{\vlin{\rrn\IMP}{}
	{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\BR{\rt{A \IMP B}}}}}
	{\vlin{\rn{F_\rn{1}}}{}
		{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\BR{\bBR{\lf{A}, \rt{B}}}}}}
		{\vlin{\lrn{mon}}{}
			{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\BR{\bBR{\lf{A}, \rt{B}}}, \bBR{\BR{\lf{A}, \rt{B}}}}}}
			{\vlin{\lrn{mon}}{}
				{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\lf{\DIA A \IMP \BOX B}, \BR{\bBR{\lf{A}, \rt{B}}}, \bBR{\BR{\lf{A}, \rt{B}}}}}}
				{\vliin{\lrn\IMP}{}
					{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\lf{\DIA A \IMP \BOX B}, \BR{\bBR{\lf{A}, \rt{B}}}, \bBR{\lf{\DIA A \IMP \BOX B}, \BR{\lf{A}, \rt{B}}}}}}
					{\vlin{\rrn\DIA}{}
						{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\Rabx, \bBR{\lf{\DIA A \IMP \BOX B}, \rt{\DIA A} \BR{\lf{A}, \rt{B}}}}}}
						{\vlin{\rn{refl}}{}
							{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\Rabx, \bBR{\lf{\DIA A \IMP \BOX B}, \rt{\DIA A} \BR{\rt{A}, \lf{A}, \rt{B}}}}}}
							{\vlin{\rn{id}}{}
								{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\Rabx, \bBR{\lf{\DIA A \IMP \BOX B}, \rt{\DIA A} \BR{\bBR{\rt{A}}, \lf{A}, \rt{B}}}}}}
								{\vlhy{}}}}}
					{\vlin{\lrn\BOX}{}
						{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\Rabx, \bBR{\lf{\BOX B}, \BR{\lf{A}, \rt{B}}}}}}
						{\vlin{\rn{refl}}{}
							{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\Rabx, \bBR{\lf{\BOX B}, \BR{ \lf{B}, \lf{A}, \rt{B}}}}}}
							{\vlin{\rn{id}}{}
								{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\Rabx, \bBR{\lf{\BOX B}, \BR{ \lf{B}, \lf{A}, \bBR{\rt{B}}}}}}}
								{\vlhy{}}}}}}}
			}
		}}}
}
$$

where $\Rabx$ is equal to $\lf{\DIA A \IMP \BOX B}, \BR{\bBR{\lf{A}, \rt{B}}}$.

%%%%%%%%%%%%%%%%%%%%k5%%%%%%%%%%%%%%%%%%
$$
\vlderivation {
		\vlin{\rrn\IMP}{}
		{\kax[5] \colon \rt{\DIA \BOT \IMP \BOT}}
		{\vlin {\lrn\DIA}{}
			{\bBR{\lf{\DIA \BOT}, \rt{\BOT}}}
			{\vlin {\lrn{\BOT}}{}
				{\bBR{\BR{\lf{\BOT}}, \rt{\BOT}}}
				{\vlhy {}}}}
	}
$$

\subsubsection{Derivation of the axioms of $\sys{IS4}$}

\[
\vlderivation{
	\vlin{\rrn\IMP}{}
	{\ax{t}_{\BOX} \colon \BOX a \IMP a}
	{\vlin{\lrn[1]\BOX}{}
		{\bBR{\lf{\BOX a}, \rt{a}}}
		{\vlin{\rn{id}}{}
			{\bBR{\lf{\BOX a}, \lf{a}, \rt{a}}}
			{\vlhy{}}}}
	}
\quad\quad\quad\quad
\vlderivation{
	\vlin{\rrn\IMP}{}
	{\ax{t}_{\DIA} \colon a \IMP \DIA a}
	{\vlin{\rrn[1]\DIA}{}
		{\bBR{\lf{a}, \rt{\DIA a}}}
		{\vlin{\rn{id}}{}
			{\bBR{\lf{a}, \rt{\DIA a}, \rt{a}}}
			{\vlhy{}}}}
	}
\]	

\[
\vlderivation{
	\vlin{\rrn\IMP}{}
	{\ax{4}_{\BOX} \colon \BOX a \IMP \BOX\BOX a}
	{\vlin{\rrn\BOX}{}
		{\bBR{\lf{\BOX a}, \rt{\BOX \BOX a}}}
		{\vlin{\lrn{mon}}{}
			{\bBR{\lf{\BOX a}, \bBR{\BR{\rt{\BOX a}}}}}
			{\vlin{\lrn[2]\BOX}{}
				{\bBR{\bBR{\lf{\BOX a}, \BR{\rt{\BOX a}}}}}
				{\vlin{\rn{id}}{}
					{\bBR{\bBR{\lf{\BOX a}, \BR{\lf{\BOX a}, \rt{\BOX a}}}}}
					{\vlhy{}}}}}}
	}
\quad\quad\quad\quad
\vlderivation{
	\vlin{\rrn\IMP}{}
	{\ax{4}_{\DIA} \colon \DIA\DIA a \IMP \DIA a}
	{\vlin{\lrn\DIA}{}
		{\bBR{\lf{\DIA \DIA a}, \rt{\DIA a}}}
		{\vlin{\rrn[2]\DIA}{}
			{\bBR{\BR{\lf{\DIA a}}, \rt{\DIA a}}}
			{\vlin{\rn{id}}{}
				{\bBR{\BR{\lf{\DIA a}, \rt{\DIA a}}, \rt{\DIA a}}}
				{}}}}
	}
\]

%\todo{Derive the axioms of $\sys{IS4}$:
%\begin{align*}
%	\ax{t}_{\BOX} \colonequals & \quad \BOX a \IMP a & \ax{t}_{\DIA} \colonequals & \quad a \IMP \DIA a\\
%	\ax{4}_{\BOX} \colonequals & \quad \BOX a \IMP \BOX\BOX a & \ax{4}_{\DIA} \colonequals & \quad  \DIA\DIA a \IMP \DIA a
%\end{align*}
%}

\subsection{Cut admissibility}

In this section we are going to prove the admissibility of cut for the system $\rn{NIK}$.

\begin{theorem}
	\label{thm:cut-adm}
	The $\rn{cut}$ rule is admissible for $\rn{NIK}$.
	\end{theorem}

\begin{lemma}
	\label{lem:weak-adm}
	The weakening rule
	~$\vlinf{\rn{weak}}{}{\Cx[1]{\Cx[2]}}{\Cx[1]{\emptyset}}$~
	is height-preserving admissible for $\rn{NIK}$.
\end{lemma}
%\sonia{You need to introduce the notation $\DD_3^{w}$ that you are using in the cut-elimination proof. Or you can just use the rule $\rn{weak}$ explicitely in the proof and use its admissiblity a posteriori.}

\begin{lemma}
	\label{lem:mon-adm}
	The monoticity rule
	~$\vlinf{\rrn{mon}}{}{\Cx[1]{\bBR{\rt A, \Cx[2]}}}{\Cx[1]{\rt A, \bBR{\Cx[2]}}}$~
	is height-preserving admissible for $\rn{NIK}$.
\end{lemma}

\begin{proof}
	By induction on the height of $\DD$, we prove that for any proof of $\Cx[1]{\rt A, \bBR{\Cx[2]}}$, then there exists a proof of $\Cx[1]{\bBR{\rt A, \Cx[2]}}$ of the same (or smaller) height.
	\todo{}
\end{proof}

\begin{lemma}
	\label{lem:m-adm}
	The rule
	~$\vlinf{\rn{m[]}}{}{\Cx[1]{\BR{\Cx[2], \Cx[3]}}}{\Cx[1]{\BR{\Cx[2]}, \BR{\Cx[3]}}}$~
	is height-preserving admissible for $\rn{NIK}$.
\end{lemma}

\begin{lemma}\marianela{Should I make the proof to show which rule is invertible?}
	\label{lem:inv}
	All single-premise rules of $\rn{NIK}$ are height-preserving
	invertible.
\end{lemma}

\sonia{It is not only the single-premise rules. All logical rules are invertible, in the sense that if the conclusion is provable, so are each premises. Structural rules, on the other hand, are (I believe) not invertible.}

\sonia{You also need to introduce the notations that you use in the cut-elimination proof for the derivations obtained by invertibility such as $\DD_2^{\rrn\IMP}$. 
	Or you could introduce a ``reverse" rule, 
	e.g.~$\vlinf{\invr{\rrn{\IMP}}}{}{\Cx{\bBR{\lf{A}, \rt{B}}}}{\Cx{\rt{A \IMP B}}}$
	if you find it easier to apply. As being invertible is equivalent to the ``reverse" rule to be height-preserving admissible. 
}
	
\begin{lemma}
	\label{lem:reduction}
	Given a derivation of shape
	$$
	\vlderivation{
		\vliiin{\labrn{mcut}}{}{\Cx{\emptyset}^n}{
			\vlhtr{\DD_1}{\Cx{\rt{C}}^n}}{
			\vlhy{}}{
			\vlhtr{\DD_2}{\Cx{\lf{C}}^n}}}
	$$
	where $\DD_1$ and $\DD_2$ are both \rn{mcut}-free, there is a cut-free
	derivation of $\Cx{\emptyset}$.
	
		\sonia{where $\Cx{\rt{C}}^n =\Cx{\rt{C}}{\ldots}{{\rt{C}}}$ with $n$ occurences of $\rt C$ anywhere in $\Cx$}
		
\end{lemma}

\sonia{this corresponds in the labelled sequent to 
	$$
	\vliinf{Ycut}{}{R, \Gamma \SEQ \Delta}{R, \Gamma \SEQ \Delta, \labels{x_1}{A}, \ldots, \labels{x_n}{A}}{R, \Gamma, \labels{x_1}{A}, \ldots, \labels{x_n}{A} \SEQ \Delta}
	$$
	%
	%There must be a derivation from ${R, \Gamma \SEQ \Delta, \labels{x_1}{A}, \ldots, \labels{x_n}{A}}$ to ${R, \Gamma \SEQ \Delta, \labels{y_1}{A}, \ldots, \labels{y_n}{A}}$
}

\begin{proof}
	%
	The proof is by a lexicographic induction on the complexity of the cut-formula $C$ and the sum of the heights $\height{\DD_1}+\height{\DD_2}$.
	%
	We perform a case analysis on the last rule used in $\DD_1$ above the $\rn{cut}$ and whether it applies to the cut-formula or not.
	%
	In case it does not, we are in a \emph{commutative} case; in case it does, we have to perform a similar analysis on $\DD_2$ to end up in a \emph{key} case.
\sonia{what is the last applied rule is an axiom?}

\textbf{Commutative cases}: In such a case, the complexity of the cut-formula stays constant, but the height of the derivation above the $\rn{cut}$ decreases.
\sonia{Need to be more precise here: I do not understand exactly what the height (singular) of the derivation above refers to.}

\begin{itemize}

\item $\lrn\IMP$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\lf{A \IMP B}}}
	{\vliin{\lrn\IMP}{}
		{\Cx{\lf{A \IMP B}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\lf{A \IMP B}, \rt{A}, \rt{C}}}}
		{\vlhtr{\DD_2}{\Cx{\lf{B}, \rt{C}}}}}
	{\vlhtr{\DD_3}{\Cx{\lf{A \IMP B}, \lf{C}}}}
	}
\reducesto
$$
$$
\vlderivation{
	\vliin{\lrn\IMP}{}
	{\Cx{\lf{A \IMP B}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\lf{A \IMP B}, \rt{A}}}
		{\vlhtr{\DD_1}{\Cx{\lf{A \IMP B}, \rt{A}, \rt{C}}}}
		{\vlhtr{\DD_3^{\rn w}}{\Cx{\lf{A \IMP B}, \rt{A}, \lf{C}}}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\lf{B}}}
		{\vlhtr{\DD_2}{\Cx{\lf{B}, \rt{C}}}}
		{\vlhtr{\DD_3^{\lrn\IMP}}{\Cx{\lf{B}, \lf{C}}}}}
	}
$$
where $\DD_3^{\rn w}$ is obtained using Lemma~\ref{lem:weak-adm} and $\DD_3^{\lrn\IMP}$ is obtained using Lemma~\ref{lem:inv}. We use the same naming scheme in the following cases.

\item $\rrn\IMP$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\rt{A \IMP B}}}
	{\vlin{}{}
		{\Cx{\rt{A \IMP B}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\bBR{\lf{A}, \rt{B}}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\rt{A \IMP B}, \lf{C}}}} 
}
\reducesto
\vlderivation{
	\vlin{\rrn\IMP}{}
	{\Cx{\rt{A \IMP B}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\bBR{\lf{A}, \rt{B}}}}
		{\vlhtr{\DD_1}{\Cx{\bBR{\lf{A}, \rt{B}}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rrn\IMP}}{\Cx{\bBR{\lf{A}, \rt{B}}, \lf{C}}}}}
}
$$

\item $\lrn\BOX$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}, \lf{\BOX A}}}
	{\vlin{\lrn\BOX}{}
		{\Cx{\BR{\Cx[1]}, \lf{\BOX A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \lf{A}}, \lf{\BOX A}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \lf{\BOX A}, \lf{C}}}}
}
\reducesto
\vlderivation{
	\vlin{\lrn\BOX}{}
	{\Cx{\BR{\Cx[1]}, \lf{\BOX A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\BR{\Cx[1], \lf{A}}, \lf{\BOX A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \lf{A}}, \lf{\BOX A}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rn w}}{\Cx{\BR{\Cx[1], \lf{A}}, \lf{\BOX A}, \lf{C}}}}}
}
$$

\item $\rrn\BOX$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\rt{\BOX A}}}
	{\vlin{\rrn\BOX}{}
		{\Cx{\rt{\BOX A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\bBR{\BR{\rt{A}}}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\rt{\BOX A}, \lf{C}}}}
}
\reducesto
\vlderivation{
	\vlin{\rrn\BOX}{}
	{\Cx{\rt{\BOX A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\bBR{\BR{\rt{A}}}}}
		{\vlhtr{\DD_1}{\Cx{\bBR{\BR{\rt{A}}}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rrn\BOX}}{\Cx{\bBR{\BR{\rt{A}}}, \lf{C}}}}}
}
$$

\item $\lrn\DIA$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\lf{\DIA A}}}
	{\vlin{\lrn\DIA}{}
		{\Cx{\lf{\DIA A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\lf{A}}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\lf{\DIA A}, \lf{C}}}}
	}
\reducesto
\vlderivation{
	\vlin{\lrn\DIA}{}
	{\Cx{\lf{\DIA A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\BR{\lf{A}}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\lf{A}}, \rt{C}}}}
		{\vlhtr{\DD_2^{\lrn\DIA}}{\Cx{\BR{\lf{A}}, \lf{C}}}}}
	}
$$

\item $\rrn\DIA$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}, \rt{\DIA A}}}
	{\vlin{\rrn\DIA}{}
		{\Cx{\BR{\Cx[1]}, \rt{\DIA A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{A}}, \rt{\DIA A}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \rt{\DIA A}, \lf{C}}}}
}
\reducesto
\vlderivation{
	\vlin{\rrn\DIA}{}
	{\Cx{\BR{\Cx[1]}, \rt{\DIA A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\BR{\Cx[1], \rt{A}}, \rt{\DIA A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{A}}, \rt{\DIA A}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rn w}}{\Cx{\BR{\Cx[1], \rt{A}}, \rt{\DIA A}, \lf{C}}}}}
}
$$

\item $\rn{F_1}$:

$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\bBR{\Cx[1]}}}}
	{\vlin{\rn{F_1}}{}
		{\Cx{\BR{\bBR{\Cx[1]}}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\bBR{\Cx[1]}}, \bBR{\BR{\Cx[1]}}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\BR{\bBR{\Cx[1]}}, \lf{C}}}}
	}
\reducesto
\vlderivation{
	\vlin{\rn{F_1}}{}{\Cx{\BR{\bBR{\Cx[1]}}}}{
		\vliin{\rn{cut}}{}{\Cx{\BR{\bBR{\Cx[1]}}, \bBR{\BR{\Cx[1]}}}}{
			\vlhtr{\DD_1^w}{\Cx{\BR{\bBR{\Cx[1]}}, \bBR{\BR{\Cx[1]}}, \rt{C}}}
		}{
			\vlhtr{\DD_2^w}{\Cx{\BR{\bBR{\Cx[1]}}, \bBR{\BR{\Cx[1]}}, \lf{C}}}
			}
		}
	}
$$

\item $\lrn{mon}$:

$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\lf{A}, \bBR{\Cx[1]}}}
	{\vlin{\lrn{mon}}{}
		{\Cx{\lf{A}, \bBR{\Cx[1]}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\lf{A}, \bBR{\lf{A}, \Cx[1]}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\lf{A}, \bBR{\Cx[1]}, \lf{C}}}}
	}
\reducesto
\vlderivation{
	\vlin{\lrn{mon}}{}
	{\Cx{\lf{A}, \bBR{\Cx[1]}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\lf{A}, \bBR{\lf{A}, \Cx[1]}}}
		{\vlhtr{\DD_1}{\Cx{\lf{A}, \bBR{\lf{A}, \Cx[1]}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rn w}}{\Cx{\lf{A}, \bBR{\lf{A}, \Cx[1]}, \lf{C}}}}}
	}
$$
\end{itemize}

\textbf{Key cases}: In the case when the last rule in $\DD_1$ and in $\DD_2$ applies to the cut-formula, it is the complexity of the cut-formula that is the decreasing inductive measure.

\begin{itemize}
\item $C=A \AND B$:
%$$
%\vlderivation{
%	\vliin{\rn{cut}}{}
%	{\Cx{\emptyset}}
%	{\vliin{\rrn\AND}{}
%		{\Cx{\rt{A \AND B}}}
%		{\vlhtr{\DD_1}{\Cx{\rt{A}}}}
%		{\vlhtr{\DD_2}{\Cx{\rt{B}}}}}
%	{\vlin{\lrn\AND}{}
%		{\Cx{\lf{A \AND B}}}
%		{\vlhtr{\DD_3}{\Cx{\lf{A}, \lf{B}}}}}
%	}
%\reducesto
%\vlderivation{
%	\vliin{\rn{cut}}{}
%	{\Cx{\emptyset}}
%	{\vlhtr{\DD_1}{\Cx{\rt{A}}}}
%	{\vliin{\rn{cut}}{}
%		{\Cx{\lf{A}}}
%		{\vlhtr{\DD_2^{\rn w}}{\Cx{\lf{A}, \rt{B}}}}
%		{\vlhtr{\DD_3}{\Cx{\lf{A}, \lf{B}}}}}
%	}
%$$
$$
\vlderivation{
	\vliin{\rn{mcut}}{}
	{\Cx\i{x}{\emptyset}\i{y}{\emptyset}{\emptyset}^n}
	{\vliin{\rrn\AND}{}
		{\Cx\i{x}{\rt{A \AND B}}\i{y}{\rt{A \AND B}}{\rt{A \AND B}}^{n}}
		{\vlhtr{\DD_1}{\Cx\i{x}{\rt{A}}\i{y}{\rt{A \AND B}}{\rt{A \AND B}}^{n}}}
		{\vlhtr{\DD_2}{\Cx\i{x}{\rt{B}}\i{y}{\rt{A \AND B}}{\rt{A \AND B}}^{n}}}
	}
	{\vlin{\lrn\AND}{}
		{\Cx\i{x}{\lf{A \AND B}}\i{y}{\lf{A \AND B}}{\lf{A \AND B}}^{n}}
		{\vlhtr{\DD_3}{\Cx\i{x}{\lf{A \AND B}}\i{y}{\lf{A}, \lf{B}}{\lf{A \AND B}}^{n}}}}
	}
$$
$$\hspace*{-2cm}
\reducesto
\vlderivation{
	\vliin{\rn{mcut}}{}
	{\Cx\i{x}{\emptyset}\i{y}{\emptyset}{\emptyset}^n}
	{\vlhtr{\DD_1'}{\Cx\i{x}{\rt{A}}\i{y}{\rt{A}}{\rt{A}}^{n}}}
	{\vliin{\rn{mcut}}{}
		{\Cx\i{x}{\lf A}\i{y}{\lf A}{\lf{A}}^n}
%		{\vlhtr{\DD_2^{\rn w}}{\Cx{\lf{A}, \rt{B}}}}
		{\vlhtr{\DD_2'}{\Cx\i{x}{\lf{A},\rt{B}}\i{y}{\lf{A},\rt{B}}{\lf{A},\rt{B}}^{n}}}
		{\vlhtr{\DD_3'}{\Cx\i{x}{\lf{A},\lf{ B}}\i{y}{\lf{A}, \lf{B}}{\lf{A}, \lf{B}}^{n}}}}
}
$$

$\DD_1'$ is obtained by applying invertibility.
$\DD_2'$ is obtained by applying invertibitily and then weakening.
$\DD_3'$ is obtained by applying invertibility.


%$$
%\vlderivation{	
%	\vliin{\rn{Y-cut}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}, \bBR{\BR{\Cx[2]}}}}{
%		\vliin{\rrn\AND}{}{\Cx[1]{\BR{\bBR{\Cx[2], \rt {A \AND B} }}, \bBR{\BR{\Cx[2], \rt {A \AND B} }}}}
%		{\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \rt {A \AND B} }}, \bBR{\BR{\Cx[2], \rt {A} }}}}}
%		{\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \rt {A \AND B} }}, \bBR{\BR{\Cx[2], \rt {B} }}}}}
%	}{
%		\vlin{\lrn\AND}{}{\Cx[1]{\BR{\bBR{\Cx[2], \lf {A \AND B}}}, \bBR{\BR{\Cx[2], \lf {A \AND B}}}}}
%		{\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \lf {A}, \lf B}}, \bBR{\BR{\Cx[2], \lf {A \AND B}}}}}}
%	}
%}
%$$
%$$
%\vlderivation{
%	\vliin{\rn{Y-cut}}{}{
%\Cx[1]{\BR{\bBR{\Cx[2]}}, \bBR{\BR{\Cx[2]}}}	
%}{
%		\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \rt {B} }}, \bBR{\BR{\Cx[2], \rt {B} }}}}
%	}{
%	\vliin{\rn{Y-cut}}{}{\Cx[1]{\BR{\bBR{\Cx[2], \lf B }}, \bBR{\BR{\Cx[2], \lf B }}}}
%	{\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \rt {A}, \lf B }}, \bBR{\BR{\Cx[2], \rt {A}, \lf B }}}}}
%	{\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \lf {A}, \lf B}}, \bBR{\BR{\Cx[2], \lf {A}, \lf B }}}}}
%}
%}
%$$



\item $C= A \OR B$:

$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vlin{\rrn\OR}{}
		{\Cx{\rt{A \OR B}}}
		{\vlhtr{\DD_1}{\Cx{ \rt{A},\rt{B}}}}}
	{\vliin{\lrn\OR}{}
		{\Cx{\lf{A \OR B}}}
		{\vlhtr{\DD_2}{\Cx{\lf{A}}}}
		{\vlhtr{\DD_3}{\Cx{\lf{B}}}}}
	}
\reducesto
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vliin{\rn{cut}}{}
		{\Cx{\rt{A}}}
		{\vlhtr{\DD_1}{\Cx{\rt{A}, \rt{B}}}}
		{\vlhtr{\DD_3^{\rn w}}{\Cx{\rt{A}, \lf{B}}}}}
	{\vlhtr{\DD_2}{\Cx{\lf{A}}}}
	}
$$	

\item $C=A \IMP B$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vlin{\rrn\IMP}{}
		{\Cx{\rt{A \IMP B}}}
		{\vlhtr{\DD_1}{\Cx{\bBR{\lf{A}, \rt{B}}}}}}
	{\vliin{\lrn\IMP}{}
		{\Cx{\lf{A \IMP B}}}
		{\vlhtr{\DD_2}{\Cx{\lf{A \IMP B}, \rt{A}}}}
		{\vlhtr{\DD_3}{\Cx{\lf{B}}}}}}
\reducesto
$$
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vliin{\rn{cut}}{}
		{\Cx{\rt{A}}}
		{\vlin{\rrn\IMP}{}
			{\Cx{\rt{A \IMP B}, \rt{A}}}
			{\vlhtr{\DD_1^{w}}{\Cx{\bBR{\lf{A}, \rt{B}}, \rt{A}}}}}
		{\vlhtr{\DD_2}{\Cx{\lf{A \IMP B}, \rt{A}}}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\lf{A}}}
		{\vlin{\rn{refl}}{}{\Cx{\lf{A}, \rt{B}}}{
				\vlhtr{\DD_1}{\Cx{\bBR{\lf{A}, \rt{B}}}}}}
		{\vlhtr{\DD_3^{\rn w}}{\Cx{\lf{A}, \lf{B}}}}}
	}
$$

\item $C=\BOX A$:
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}}}
	{\vlin{\rrn\BOX}{}
		{\Cx{\BR{\Cx[1]}, \rt{\BOX A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1]}, \bBR{\BR{\rt{A}}}}}}}
	{\vlin{\lrn\BOX}{}
		{\Cx{\BR{\Cx[1]}, \lf{\BOX A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1], \lf{A}}, \lf{\BOX A}}}}}
}
\reducesto
$$
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}}}
	{\vlin{\rn{m[]}}{}
		{\Cx{\BR{\Cx[1], \rt{A}}}}
		{\vlin{\rn{refl}}{}
			{\Cx{\BR{\Cx[1]}, \BR{\rt{A}}}}
			{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1]}, \bBR{\BR{\rt{A}}}}}}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\BR{\Cx[1], \lf{A}}}}
		{\vlin{\rrn\BOX}{}
			{\Cx{\BR{\Cx[1], \lf{A}}, \rt{\BOX A}}}
			{\vlhtr{\DD_1^{\rn w}}{\Cx{\BR{\Cx[1], \lf{A}}, \bBR{\BR{\rt{A}}}}}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1], \lf{A}}, \lf{\BOX A}}}}
		}}
$$

\sonia{it is interesting to observe that in the labelled calculus for the same case, we would need to use a global substitution, but here we have a structural version of it, namely the $\rn{m[]}$-rule.}
\marianela{I agree :) }

\item $C=\DIA A$:
 
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}}}
	{\vlin{\rrn\DIA}{}
		{\Cx{\BR{\Cx[1]}, \rt{\DIA A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{A}}, \rt{\DIA A}}}}}
	{\vlin{\lrn\DIA}{}
		{\Cx{\BR{\Cx[1]}, \lf{\DIA A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \BR{\lf{A}}}}}}
	}
\reducesto
$$
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\BR{\Cx[1], \rt{A}}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{A}}, \rt{\DIA A}}}}
		{\vlin{\lrn\DIA}{}
			{\Cx{\BR{\Cx[1], \rt{A}}, \lf{\DIA A}}}
			{\vlhtr{\DD_2^{\rn w}}{\Cx{\BR{\Cx[1], \rt{A}}, \BR{\lf{A}}}}}}}
	{\vlin{\rn{m[]}}{}
		{\Cx{\BR{\Cx[1], \lf{A}}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \BR{\lf{A}}}}}}
	}
$$

\item \todo{$F_1$ when the right cut-formula is used  in $F_1$}
$$
\vlderivation{
	\vliin{\rn{cut}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{
		\vlin{F_1}{}{\Cx[1]{\BR{\bBR{\Cx[2]{\rt A} }}}}{
			\vlhy{\Cx[1]{\BR{\bBR{\Cx[2]{\rt A} }}, \bBR{\BR{\Cx[2]{\rt A }}}}}
			}
		}{
		\vlhy{\Cx[1]{\BR{\bBR{\Cx[2]{\lf A}}}}}
		}
	}
$$
$$
\quad\leadsto\quad
\vlderivation{	
\vlin{\rn{F_1}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{
	\vliin{\rn{Y-cut}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}, \bBR{\BR{\Cx[2]}}}}{
		\vlhy{\Cx[1]{\BR{\bBR{\Cx[2]{\rt A} }}, \bBR{\BR{\Cx[2]{\rt A}}}}}
	}{
	\vlin{\rn w}{}{\Cx[1]{\BR{\bBR{\Cx[2]{\lf A}}}, \bBR{\BR{\Cx[2]{\lf A}}}}}{
		\vlhy{\Cx[1]{\BR{\bBR{\Cx[2]{\lf A}}}}}
		}
	}
}}
$$

$$
\equiv\quad
\vlderivation{
\vliin{\rn{Y-cut}}{}{\Cx[1]{\BR{\bBR{\Cx[3]{\BR{\bBR{\Cx[4] }}}}}, \bBR{\BR{\Cx[2]}}}}{
	\vlin{\rn{F_1}}{}{\Cx[1]{\BR{\bBR{\Cx[3]{\BR{\bBR{\Cx[4]{\rt A} }}}}}, \bBR{\BR{\Cx[2]{\rt A} }}}
	}{
	\vlhy{\Cx[1]{\BR{\bBR{\Cx[3]{\BR{\bBR{\Cx[4]{\rt A} }}, \bBR{\BR{\Cx[4]{\rt A} }}}}}, \bBR{\BR{\Cx[2]{\rt A} }}}	}
}
}{
	\vlhy{\Cx[1]{\BR{\bBR{\Cx[3]{\BR{\bBR{\Cx[4]{\lf A} }}}}}, \bBR{\BR{\Cx[2]{\lf A}}}}}
}
}
$$

\item \todo{$F_1$ when the left cut-formula is used in $F_1$}
$$
\vlderivation{
	\vliin{\rn{cut}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{
		\vlin{F_1}{}{\Cx[1]{\BR{\bBR{\Cx[2], \lf A }}}}{
			\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \lf A }}, \bBR{\BR{\Cx[2], \lf A }}}}
		}
	}{
		\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \rt A}}}}
	}
}
\quad\leadsto\quad
\vlderivation{	
	\vliin{\rn{Y-cut}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{
		\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \lf A }}, \bBR{\BR{\Cx[2], \lf A }}}}
	}{
	\vlhy{\Cx[1]{\BR{\bBR{\Cx[2], \rt A}}}}
	}
}
$$

\item \sonia{monotonicity}
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\bBR{\Cx[1]}}}
	{\vlhtr{\DD_1}{\Cx{\bBR{\Cx[1]}, \rt{A}}}}
	{\vlin{\lrn{mon}}{}
		{\Cx{\bBR{\Cx[1]}, \lf{A}}}
		{\vlhtr{\DD_2}{\Cx{\bBR{\Cx[1], \lf{A}}, \lf{A}}}}}
	}
\reducesto
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\bBR{\Cx[1]}}}
	{\vlin{\rrn{mon}}{}
		{\Cx{\bBR{\Cx[1], \rt{A}}}}
		{\vlhtr{\DD_1}{\Cx{\bBR{\Cx[1]}, \rt{A}}}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\bBR{\Cx[1], \lf{A}}}}
		{\vlhtr{\DD_1^{\rn w}}{\Cx{\bBR{\Cx[1], \lf{A}}, \rt{A}}}}
		{\vlhtr{\DD_2}{\Cx{\bBR{\Cx[1], \lf{A}}, \lf{A}}}}}
	}
$$
\end{itemize}

\end{proof}

\subsubsection{Cut-Elimination for IS4}

\todo{This does not quite work. In both cases below, the induction measure cannot be applied to one of the cuts that the reduction produces. I added two (probably admissible) rules to the system, they would probably allow you to solve these cases.}

\textbf{Key cases}:

\begin{itemize}
\item $C=\BOX A$ capturing $\lrn[1]\BOX$:
\marianela{Think is ok now.}
$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vlin{\rrn\BOX}{}
		{\Cx{\rt{\BOX A}}}
		{\vlhtr{\DD_1}{\Cx{\bBR{\BR{\rt{A}}}}}}}
	{\vlin{\lrn[1]\BOX}{}
		{\Cx{\lf{\BOX A}}}
		{\vlhtr{\DD_2}{\Cx{\lf{\BOX A}, \lf{A}}}}}
	}
\reducesto
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vlin{\rn{t[]}}{}
		{\Cx{\rt{A}}}
		{\vlin{\rn{refl}}{}
			{\Cx{\BR{\rt{A}}}}
			{\vlhtr{\DD_1}{\Cx{\bBR{\BR{\rt{A}}}}}}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\lf{A}}}
		{\vlin{\rrn\BOX}{}
			{\Cx{\lf{A}, \rt{\BOX A}}}
			{\vlhtr{\DD_1^{\rn w}}{\Cx{\lf{A}, \bBR{\BR{\rt{A}}}}}}}
		{\vlhtr{\DD_2}{\Cx{\lf{A}, \lf{\BOX A}}}}}
	}
$$

\item $C=\BOX A$ capturing $\lrn[2]\BOX$:

$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}}}
	{\vlin{\rrn\BOX}{}
		{\Cx{\BR{\Cx[1]}, \rt{\BOX A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1]}, \bBR{\BR{\rt{A}}}}}}}
	{\vlin{\lrn[2]\BOX}{}
		{\Cx{\BR{\Cx[1]}, \lf{\BOX A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \lf{\BOX A}}}}}
	}
\reducesto
\vlderivation{
	\vliin{\rn{\BOX4-cut}}{}
	{\Cx{\BR{\Cx[1]}}}
	{\vlin{\rrn\BOX}{}
		{\Cx{\BR{\Cx[1]}, \rt{\BOX A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1]}, \bBR{\BR{\rt{A}}}}}}}		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \lf{\BOX A}}}}}
$$
%$$
%\vlderivation{
%	\vliin{\rn{cut}}{}
%	{\Cx{\BR{\Cx[1]}}}
%	{\vlin{\rn{m[]}}{}
%		{\Cx{\BR{\Cx[1], \rt{\BOX A}}}}
%		{\vlin{\rrn\BOX}{}
%			{\Cx{\BR{\Cx[1]}, \BR{\rt{\BOX A}}}}
%			{\vlin{F_1}{}{\Cx{\BR{\Cx[1]}, \BR{\bBR{\BR{\rt{A}}}}}}{
%				\vlin{4[]}{}{\Cx{\BR{\Cx[1]}, \bBR{\BR{\BR{\rt{A}}}}}}{
%					\vlid{w}{}{\Cx{\BR{\Cx[1]}, \bBR{\BR{\rt{A}}, \BR{}}}}{
%						\vlhtr{\DD_1}{\Cx{\BR{\Cx[1]}, \bBR{\BR{\rt{A}}}}}
%						}
%					}	
%				}
%			}
%		}
%	}
%	{\vliin{\rn{cut}}{}
%		{\Cx{\BR{\Cx[1], \lf{\BOX A}}}}
%		{\vlin{}{}
%			{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \rt{\BOX A}}}
%			{\vlhtr{\DD_1^{\rn w}}{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \bBR{\BR{\rt{A}}}}}}}
%		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \lf{\BOX A}}}}}
%	}
%$$
\item $C=\DIA A$ capturing $\rrn[1]\DIA$:
\marianela{Think is ok now.}
$$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vlin{\rrn[1]\DIA}{}
		{\Cx{\rt{\DIA A}}}
		{\vlhtr{\DD_1}{\Cx{\rt{\DIA A}, \rt{A}}}}}
	{\vlin{\lrn\DIA}{}
		{\Cx{\lf{\DIA A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\lf{A}}}}}}
	}
\reducesto
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\emptyset}}
	{\vliin{\rn{cut}}{}
		{\Cx{\rt{A}}}
		{\vlhtr{\DD_1}{\Cx{\rt{A}, \rt{\DIA A}}}}
		{\vlin{\lrn\DIA}{}
			{\Cx{\rt{A}, \lf{\DIA A}}}
			{\vlhtr{\DD_2^{\rn w}}{\Cx{\rt{A}, \BR{\lf{A}}}}}}}
	{\vlin{\rn{t[]}}{}
		{\Cx{\lf{A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\lf{A}}}}}}
	}$$
	
\item $C=\DIA A$ capturing $\rrn[2]\DIA$:

$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}}}
	{\vlin{\rrn[2]{\DIA}}{}
		{\Cx{\BR{\Cx[1]}, \rt{\DIA A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{\DIA A}}, \rt{\DIA A}}}}}
	{\vlin{\lrn\DIA}{}
		{\Cx{\BR{\Cx[1]}, \lf{\DIA A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \BR{\lf{A}}}}}}
	}
\reducesto
\vlderivation{
	\vliin{\rn{\DIA4-cut}}{}
	{\Cx{\BR{\Cx[1]}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{\DIA A}}, \rt{\DIA A}}}}
	{\vlin{\lrn\DIA}{}
		{\Cx{\BR{\Cx[1]}, \lf{\DIA A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \BR{\lf{A}}}}}}
}
%\vlderivation{
%	\vliin{\rn{cut}}{}
%	{\Cx{\BR{\Cx[1]}}}
%	{\vliin{\rn{cut}}{}
%		{\Cx{\BR{\Cx[1]}, \rt{A}}}
%		{\vlin{}{}
%			{\Cx{\BR{\Cx[1], \rt{\DIA A}}, \rt{A}}}
%			{\vlhy{}}}
%		{\vlin{}{}
%			{\Cx{\BR{\Cx[1], \lf{\DIA A}}, \rt{A}}}
%			{\vlhy{}}}}
%	{\vlin{\rn{t[]}}{}
%		{\Cx{\BR{\Cx[1]}, \lf{A}}}
%		{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \BR{\lf{A}}}}}}
%	}
$$
	
\end{itemize}

\textbf{Commutative cases}:

\begin{itemize}
\item $\lrn[1]\BOX$:

$$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\lf{\BOX A}}}
	{\vlin{\lrn[1]\BOX}{}
		{\Cx{\lf{\BOX A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\lf{\BOX A}, \lf{A},  \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\lf{\BOX A}, \lf{C}}}}
	}
\reducesto
\vlderivation{
	\vlin{\lrn[1]\BOX}{}
	{\Cx{\lf{\BOX A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\lf{\BOX A}, \lf{A}}}
		{\vlhtr{\DD_1}{\Cx{\lf{\BOX A}, \lf{A}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rn w}}{\Cx{\lf{\BOX A}, \lf{A}, \lf{C}}}}}
	}
$$

\item $\lrn[2]\BOX$:

$$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}, \lf{\BOX A}}}
	{\vlin{\lrn[2]\BOX}{}
		{\Cx{\BR{\Cx[1]}, \lf{\BOX A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \lf{\BOX A}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \lf{\BOX A}, \lf{C}}}}
	}
\reducesto
\vlderivation{
	\vlin{\lrn[2]\BOX}{}
	{\Cx{\BR{\Cx[1]}, \lf{\BOX A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \lf{\BOX A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \lf{\BOX A}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rn w}}{\Cx{\BR{\Cx[1], \lf{\BOX A}}, \lf{\BOX A}, \lf{C}}}}}
	}$$

\item $\rrn[1]\DIA$:

$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\rt{\DIA A}}}
	{\vlin{\rrn[1]\DIA}{}
		{\Cx{\rt{\DIA A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\rt{\DIA A}, \rt{A},  \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\rt{\DIA A}, \lf{C}}}}
	}
\reducesto
\vlderivation{
	\vlin{\rrn[1]\DIA}{}
	{\Cx{\rt{\DIA A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\rt{\DIA A}, \rt{A}}}
		{\vlhtr{\DD_1}{\Cx{\rt{\DIA A}, \rt{A}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rn w}}{\Cx{\rt{\DIA A}, \rt{A}, \lf{C}}}}}
	}
$$

\item $\rrn[2]\DIA$:

$$
\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Cx[1]}, \rt{\DIA A}}}
	{\vlin{\rrn[2]\DIA}{}
		{\Cx{\BR{\Cx[1]}, \rt{\DIA A}, \rt{C}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{\DIA A}}, \rt{\DIA A}, \rt{C}}}}}
	{\vlhtr{\DD_2}{\Cx{\BR{\Cx[1]}, \rt{\DIA A}, \lf{C}}}}
	}
\reducesto
\vlderivation{
	\vlin{\rrn[2]\DIA}{}
	{\Cx{\BR{\Cx[1]}, \rt{\DIA A}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\BR{\Cx[1], \rt{\DIA A}}, \rt{\DIA A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Cx[1], \rt{\DIA A}}, \rt{\DIA A}, \rt{C}}}}
		{\vlhtr{\DD_2^{\rn w}}{\Cx{\BR{\Cx[1], \rt{\DIA A}}, \rt{\DIA A}, \lf{C}}}}}
	}
$$
\end{itemize}

\section{Proof transformation from $\rn{NIK}$ to $\rn{NKK}$}

\begin{itemize}

\item Rule $\ORW$:

$$\vlderivation{
\vlderivation{
\vlin{\ORW}{}
{\Cx{\rt{A \OR B}}}
{\vlhtr{\DD_1}{\Cx{\rt{A}}}}}	
}
\mbox{or}
\vlderivation{
\vlin{\ORW}{}
{\Cx{\rt{A \OR B}}}
{\vlhtr{\DD_1}{\Cx{\rt{B}}}}
}	
\reducesto
\vlderivation{
\vlin{\rrn\OR}{}
{\Cx{\rt{A \OR B}}}
{\vlhtr{\DD_1^{\rn w}}{\Cx{\rt{A}, \rt{B}}}}}
$$

\item Rule $\IMPB$:

$$
\vlderivation{
\vliin{\IMPB}{}
{\Cx{\lf{A \IMP B}}}
{\vlhtr{\DD_1}{\Cx{\rt{A}}}}
{\vlhtr{\DD_2}{\Cx{\lf{B}}}}
}
\reducesto
\vlderivation{
\vliin{\lrn\IMP}{}
{\Cx{\lf{A \IMP B}}}
{\vlhtr{\DD_1^{\rn w}}{\Cx{\lf{A \IMP B}, \rt{A}}}}
{\vlhtr{\DD_2}{\Cx{\lf{B}}}}	
}
$$

\item Rule $\IMPW$:

\todo{}
$$
\vlderivation{\vlin{\IMPW}{}
{\Cx{\rt{A \IMP B}}}
{\vlhtr{\DD_1}{\Cx{\lf{A}, \rt{B}}}}}
\reducesto
\vlderivation{
	\vlin{\rrn\IMP}{}
	{\Cx{\rt{A \IMP B}}}
	{\vlin{\rn{mon_{R}}}{}
		{\Cx{\bBR{\lf{A}, \rt{B}}}}
		{\vlin{}{}
			{\Cx{\bBR{\lf{A}}, \rt{B}}}
			{}}}
	}
$$

\item Rule $\BOXB$:

$$
\vlderivation{
\vlin{\BOXB}{}
{\Cx{\lf{\BOX A}, \BR{\Cx[1]}}}
{\vlhtr{\DD_1}{\Cx{\BR{\lf{A}, \Cx[1]}}}}	
}
\reducesto
\vlderivation{
\vlin{}{}
{\Cx{\lf{\BOX A}, \BR{\Cx[1]}}}
{\vlhtr{\DD_1^{\rn w}}{\Cx{\lf{\BOX A}, \BR{\lf{A}, \Cx[1]}}}}
}
$$

\item Rule $\BOXW$:

\todo{}
$$
\vlderivation{
\vlin{\BOXW}{}
{\Cx{\rt{\BOX A}}}
{\vlhtr{\DD_1}{\Cx{\BR{\rt{A}}}}}
}
\reducesto
\vlderivation{
\vlin{\rrn\BOX}{}
{\Cx{\rt{\BOX A}}}
{\vlin{}{}
{\Cx{\bBR{\BR{\rt{A}}}}}
{\vlhtr{}{}}}	
}
$$
\end{itemize}
%% Bibliography
%\bibliographystyle{plain}
%\bibliography{references}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}