\documentclass{article}


\newcommand{\todo}[1]{\textcolor{red}{TODO: #1}}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\blue}[1]{{\color{blue}{#1}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Packages
\usepackage{geometry}
\geometry{vmargin=3.2cm,hmargin=3.5cm}%
\usepackage{rotating}

\usepackage{amsmath} % for improving the structure and printed output of documents containing mathematical formulas

\usepackage{amssymb} % for mathematical symbols and fonts
\usepackage{bm} % command \bm makes its ar­gu­ment bold, better than \boldsymbol{}
\usepackage{colonequals} % symbols := and ::=
\usepackage{cmll}  % Linear Logic symbols
\usepackage{wasysym} % for smiley 

\usepackage[matrix,arrow]{xy}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}%[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{question}[theorem]{Question}
\newtheorem{conjecture}[theorem]{Conjecture}
\renewcommand\qedsymbol{$\smiley$}

\usepackage{graphicx} % for graphics, and commands like \scalebox{h-scale}{text} in particular

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Proof package
\usepackage[noxy]{virginialake}
\vlnosmallleftlabels
\vlnostructuressyntax
%
\newcommand{\vlhtr}[2]{\vlpd{#1}{}{#2}}
%
\newcommand{\vlderivationauxnc}[1]{#1{\box\derboxone}\vlderivationterm}
\newcommand{\vlderivationnc}{\vlderivationinit\vlderivationauxnc}
%
%
\makeatletter
\newbox\@conclbox
\newdimen\@conclheight
%
\newcommand\vlderibase[4]{{%
		\setbox\@conclbox=\hbox{$#3$}\relax%
		\@conclheight=\ht\@conclbox%
		\setbox\@conclbox=\hbox{$%
			\vlderivationnc{%
				\vlin{#1}{#2}{\box\@conclbox}{#4}%
			}$}%
		\lower\@conclheight\box\@conclbox%
	}}
	%
	\newcommand\vlderidbase[4]{{%
			\setbox\@conclbox=\hbox{$#3$}\relax%
			\@conclheight=\ht\@conclbox%
			\setbox\@conclbox=\hbox{$%
				\vlderivationnc{%
					\vlid{#1}{#2}{\box\@conclbox}{#4}%
				}$}%
			\lower\@conclheight\box\@conclbox%
		}}
		%
		\newcommand\vlderiibase[5]{{%
				\setbox\@conclbox=\hbox{$#3$}\relax%
				\@conclheight=\ht\@conclbox%
				\setbox\@conclbox=\hbox{$%
					\vlderivationnc{%
						\vliin{#1}{#2}{\box\@conclbox}{#4}{#5}%
					}$}%
				\lower\@conclheight\box\@conclbox%
			}}
			\makeatother
			%
			
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
			%%% Equation environments
			\newdimen\mydisplayskip
			\mydisplayskip=.4\abovedisplayskip
			\newenvironment{smallequation}
			{\par\nobreak\vskip\mydisplayskip\noindent\bgroup\small\csname equation\endcsname}{\csname endequation\endcsname\egroup}
			\newenvironment{smallequation*}
			{\par\nobreak\vskip\mydisplayskip\noindent\bgroup\small\csname equation*\endcsname}{\csname endequation*\endcsname\egroup}
			\newenvironment{smallalign}
			{\par\nobreak\noindent\bgroup\small\csname align\endcsname}{\csname endalign\endcsname\egroup}
			\newenvironment{smallalign*}
			{\par\nobreak\noindent\bgroup\small\csname align*\endcsname}{\csname endalign*\endcsname\egroup}
			%\newenvironment{smallmultline}
			%{\par\nobreak\vskipmydisplayskip\noindent\bgroup\small\csname multline*\endcsname}{\csname endmultline*\endcsname\egroup}
			
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Extracting symbols from MnSymbol 
\DeclareFontFamily{U} {MnSymbolC}{}

\DeclareFontShape{U}{MnSymbolC}{m}{n}{
<-6>  MnSymbolC5
<6-7>  MnSymbolC6
<7-8>  MnSymbolC7
<8-9>  MnSymbolC8
<9-10> MnSymbolC9
<10-12> MnSymbolC10
<12->   MnSymbolC12}{}
\DeclareFontShape{U}{MnSymbolC}{b}{n}{
<-6>  MnSymbolC-Bold5
<6-7>  MnSymbolC-Bold6
<7-8>  MnSymbolC-Bold7
<8-9>  MnSymbolC-Bold8
<9-10> MnSymbolC-Bold9
<10-12> MnSymbolC-Bold10
<12->   MnSymbolC-Bold12}{}

\DeclareSymbolFont{MnSyC}         {U}  {MnSymbolC}{m}{n}

%\DeclareMathSymbol{\triangleright}{\mathbin}{MnSyC}{80}
\DeclareMathSymbol{\diamondplus}{\mathbin}{MnSyC}{124}
\DeclareMathSymbol{\boxtimes}{\mathbin}{MnSyC}{117}
\DeclareMathSymbol{\meddiamond}{\mathbin}{MnSyC}{110}
\DeclareMathSymbol{\medsquare}{\mathbin}{MnSyC}{106}
\DeclareMathSymbol{\vee}{\mathbin}{MnSyC}{45}
\DeclareMathSymbol{\wedge}{\mathbin}{MnSyC}{44}
\DeclareMathSymbol{\bot}{\mathbin}{MnSyC}{150}
\DeclareMathSymbol{\top}{\mathbin}{MnSyC}{151}
%\DeclareMathSymbol{\forall}{\mathbin}{MnSyC}{166}
%\DeclareMathSymbol{\exists}{\mathbin}{MnSyC}{167}
%\DeclareMathSymbol{\smalldiamond}{\mathbin}{MnSyC}{108}
%\DeclareMathSymbol{\filleddiamond}{\mathbin}{MnSyC}{109}	 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% General maths
\newcommand*\mdelim[3]{%
\mathopen{}\left#1%
#3%
\right#2\mathclose{}%
}

\newcommand*{\tuple}{\mdelim{\langle}{\rangle}}

\newcommand*{\DD}{\mathcal{D}}

\newcommand*{\reducesto}{\quad{\leadsto}\quad}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Connectives
\newcommand*{\NEG}[1]{\bar{#1}}
\newcommand*{\NOT}{\neg}
\newcommand*{\AND}{\mathbin{\scalebox{.85}{\raise.1ex\hbox{\large$\wedge$}}}}
\newcommand*{\TOP}{\mathord{\top}}
\newcommand*{\OR}{\mathbin{\scalebox{.85}{\raise.1ex\hbox{\large$\vee$}}}}
\newcommand*{\BOT}{\mathord{\bot}}
\newcommand*{\IMP}{\mathbin{\scalebox{.6}{\raise.4ex\hbox{\large$\bm\supset$}}}}%\supset}}%

\newcommand*{\BOX}{\mathord{\medsquare}}
\newcommand*{\DIA}{\mathord{\scalebox{.9}{\raise.1ex\hbox{$\meddiamond$}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Logic
\newcommand*{\ax}[1]{\mathsf{#1}}
\newcommand*{\kax}[1][]		{\ax{k_{#1}}}

\newcommand*{\A}{\mathcal{A}}
\newcommand*{\F}{\mathcal{F}}
\newcommand*{\M}{\mathfrak{M}}

\newcommand{\force}[2]{#1\Vdash#2}
\newcommand{\nforce}[2]{#1\nVdash#2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Systems
\newcommand*{\sys}[1]{\ensuremath{\mathsf{#1}}}%\xspace}
\newcommand*{\K}{\sys{K}}
\newcommand*{\IK}{\sys{IK}}
\newcommand*{\CK}{\sys{CK}}

\newcommand*{\lab}{\mathsf{lab}}
\newcommand*{\labK}{\lab\K}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Labelled sequents
\newcommand{\SEQ}{\Rightarrow}

\newcommand*{\Labx}{\mathcal{L}}
\newcommand*{\Rabx}{\mathcal{R}}
\newcommand*{\Gx}{\mathcal{G}}
\newcommand*{\Bx}{\mathcal{B}}
\newcommand*{\labels}[2]{{\color{blue}{#1}\:\colon}{#2}}
\newcommand*{\rel}{R}

\newcommand*{\BBot}{\Perp} % \usepackage{cmll} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Rules
\newcommand*{\rn}[1]  {\ensuremath{\mathsf{#1}}}
\newcommand*{\invr}[1]{#1^\bullet}
%
\newcommand*{\orn}[2][]  {\rn{#2}_{#1}}%^{\lab}}}
\newcommand*{\rrn}[2][]  {\rn{#2}_\rn{R#1}}%^\lab}}
\newcommand*{\lrn}[2][]  {\rn{#2}_\rn{L#1}}%^\lab}}
%
\newcommand*{\labrn}[2][]  {\rn{#2}_{#1}}%^{\lab}}}
%\newcommand*{\rlabrn}[2][]  {\rn{#2}_\rn{R#1}}%^\lab}}
%\newcommand*{\llabrn}[2][]  {\rn{#2}_\rn{L#1}}%^\lab}}

\newcommand*{\brsym}{\mathord{\scalebox{.9}{$\boxtimes$}}}
\newcommand*{\boxbrn}[1]{\rn{\brsym_\rn{#1}}}%^{\lab}}}
\newcommand*{\diasym}{\mathord{\diamondplus}}
\newcommand*{\diabrn}[1][]{\rn{\diasym_\rn{#1}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Nested sequents
\makeatletter
%\newcommand*\BR[2][]{\mdelim{\lbrack\strut^{#1}}{\rbrack}{#2}}
\newcommand*{\BR}{%
\@ifnextchar\i{\br@two}{%
\@ifnextchar\bgroup{\br@one}{% 
}}}
\newcommand*{\br@one}[1]{%
\def\br@{#1}%
\mdelim{\lbrack}{\rbrack}{\ifx\br@\empty\mkern 3mu\else #1\fi}%
}
\newcommand*{\br@two}[3]{%
\def\br@{#3}%
\mdelim{\lbrack\strut^{#2}}{\rbrack}{\ifx\br@\empty\mkern 3mu\else #3\fi}%
}
%
\newcommand*{\bBR}{%
\@ifnextchar\i{\bbr@two}{%
\@ifnextchar\bgroup{\bbr@one}{% 
}}}
\newcommand*{\bbr@one}[1]{%
\def\br@{#1}%
\mdelim{\llbracket}{\rrbracket}{\ifx\br@\empty\mkern 3mu\else #1\fi}%
}
\newcommand*{\bbr@two}[3]{%
\def\br@{#3}%
\mdelim{\llbracket\strut^{#2}}{\rrbracket}{\ifx\br@\empty\mkern 3mu\else #3\fi}%
}
%
%\newcommand*{\@makeoperator}[2]{
%	\newcommand*{#1}{%
%		\mathrm{#2}\mdelim{\lparen}{\rparen}
%	}
%}
%%
%\@makeoperator{\fm}{fm^{\n}}
%\@makeoperator{\ofm}{fm^{\o}}
%\@makeoperator{\hfm}{fm^{\h}}
%%
%\@makeoperator{\depth}{dp}
%\@makeoperator{\rank}{rk}
%\@makeoperator{\height}{ht}
%\@makeoperator{\tree}{tree}
%\@makeoperator{\graph}{graph}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% contexts
\makeatletter
\newcommand*{\cxs}{%
\@ifnextchar\i{\cxs@two}{%
\@ifnextchar\bgroup{\cxs@one}{% % \bgroup is the same as {
}}}
\newcommand*{\cxs@one}[1]{%
	\def\cxs@{#1}%
	\mdelim{\lbrace}{\rbrace}{\ifx\cxs@\empty\mkern 3mu\else #1\fi}%
	\cxs@one@decor%
}
\newcommand*{\cxs@two}[3]{%
	\def\cxs@{#3}%
	\mdelim{\lbrace\strut^{#2}}{\rbrace}{\ifx\cxs@\empty\mkern 3mu\else #3\fi}%
	\cxs@one@decor%
}
\def\cxs@one@decor{%
	\@ifnextchar_{\cxs@one@sub}{%
		\@ifnextchar^{\cxs@one@sup}{%
			\@ifnextchar\dots{\@firstoftwo{\dotsm\cxs@one@decor}}{%
				\@ifnextchar[{\cxs@one@arg}%]
				\cxs}}}%
}
\def\cxs@one@sub_#1{_{#1}\cxs@one@decor}
\def\cxs@one@sup^#1{^{#1}\cxs@one@decor}
\def\cxs@one@arg[#1]{{#1}\cxs@one@decor}

%% Change these as needed, but keep the \cx@continuation at the end
\def\cx@delete@always#1{{#1}^{\ast}\cx@continuation}
\def\cx@delete@right#1*{{#1}^{\star}\cx@continuation}
\def\cx@delete@focus#1\f{{#1}^{\scriptscriptstyle\not{\langle}{\rangle}}\cx@continuation}

\def\cx@delete@star#1*{%
	\@ifnextchar*{\cx@delete@right{#1}}{\cx@delete@always{#1}}%
}

\newcommand*{\@makecontextual}[2]{
	\newcommand*{#1}{%
		\@ifnextchar*{\cx@delete@star{#2}}{%
			\@ifnextchar\f{\cx@delete@focus{#2}}{%
				#2\cx@continuation}}%
	}%
}
\newcommand*{\cx@continuation}[1][]{_{#1}\cxs}

\@makecontextual{\Ex}{}

\@makecontextual{\Cx}{\Gamma}
\@makecontextual{\Dx}{\Delta}
\@makecontextual{\Lx}{\Lambda}
\@makecontextual{\Rx}{\Pi}

\@makecontextual{\LLx}{\Omega}
\@makecontextual{\RRx}{\Xi}
\@makecontextual{\CCx}{\Sigma}
\@makecontextual{\DDx}{\Theta}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% intuitionistic
\newcommand*{\rt}[1]{#1^\circ}
\newcommand*{\lf}[1]{#1^\bullet}
\begin{document}

\section{Bicolor nested sequent systems}

\paragraph{For $\IK$}

\[
%\vlinf{\rn{id}}{}{\Cx[1]{\lf A, \bBR{\rt A, \Cx[2]}}}{}
\vlinf{\rn{id}}{}{\Cx{\lf A, \rt A}}{}
\quad
\vlinf{\lrn{\BOT}}{}{\Cx{\lf \BOT}}{}
\]
\[
\vlinf{\lrn\AND}{}{\Cx{\lf{A \AND B}}}{\Cx{\lf A, \lf B}}
\quad
\vliinf{\rrn\AND}{}{\Cx{\rt{A \AND B}}}{\Cx{\rt A}}{\Cx{\rt B}}
\quad
\vliinf{\lrn\OR}{}{\Cx{\lf{A \OR B}}}{\Cx{\lf A}}{\Cx{\lf B}}
\quad
\vlinf{\rrn\OR}{}{\Cx{\rt{A \OR B}}}{\Cx{\rt A, \rt B}}
\]
\[
%\vliinf{\lrn\IMP}{}{\Cx[1]{\lf{A \IMP B}, \bBR{\Cx[2]}}}{\Cx[1]{\lf{A \IMP B}, \bBR{\rt A, \Cx[2]}}}{\Cx[1]{\bBR{\lf B, \Cx[2]}}}
%
\vliinf{\lrn\IMP}{}{\Cx[1]{\lf{A \IMP B}}}{\Cx[1]{\rt A}}{\Cx[1]{\lf B}}
\quad
%\vlinf{\lrn[2]\IMP}{}{\Cx[1]{\lf{A \IMP B}, \bBR{\Cx[2]}}}{\Cx[1]{\bBR{\lf{A \IMP B}, \Cx[2]}}}
\quad
\vlinf{\rrn\IMP}{}{\Cx{\rt{A \IMP B}}}{\Cx{\bBR{\lf A, \rt B}}}
\]
\[
%\vlinf{\lrn\BOX}{}{\Cx[1]{\lf{\BOX A}, \bBR{\BR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\lf A, \Cx[2]}}}}
\vlinf{\lrn\BOX}{}{\Cx[1]{\lf{\BOX A}, \BR{\Cx[2]}}}{\Cx[1]{\BR{\lf A, \Cx[2]}}}
\quad
\vlinf{\rrn\BOX}{}{\Cx{\rt{\BOX A}}}{\Cx{\bBR{\BR{\rt A}}}}
\quad
\vlinf{\lrn\DIA}{}{\Cx{\lf{\DIA A}}}{\Cx{\BR{\lf A}}}
\quad
\vlinf{\rrn\DIA}{}{\Cx[1]{\rt{\DIA A}, \BR{\Cx[2]}}}{\Cx[1]{\BR{\rt A, \Cx[2]}}}
\]
\[
\vlinf{\lrn{mon}}{}{\Cx[1]{\lf A, \bBR{\Cx[2]}}}{\Cx[1]{\bBR{\lf A, \Cx[2]}}}
\quad
\vlinf{\rn{F_1}}{}{\Cx[1]{\BR{\bBR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\Cx[2]}}}}
\]
\[
\vlinf{\rrn{mon}}{}{\Cx[1]{\bBR{\rt A, \Cx[2]}}}{\Cx[1]{\rt A, \bBR{\Cx[2]}}}
\quad
\vlinf{\rn{refl}_\le}{}{\Cx[1]{\Cx[2]}}{\Cx[1]{\bBR{\Cx[2]}}}
\quad
\vlinf{\rn{trans}_\le}{}{\Cx[1]{\bBR{\Cx[2], \bBR{\Cx[3]}}}}{\Cx[1]{\bBR{\Cx[2]}, \bBR{\Cx[3]}}}
\]


\paragraph{For $\sys{IS4}$}
Replace $\lrn\BOX$ and $\rrn\DIA$ above by the following:
\[
\vlinf{\lrn[1]\BOX}{}{\Cx[1]{\lf{\BOX A}}}{\Cx{\lf A}}
\quad
%\vlinf{\lrn[2]\BOX}{}{\Cx[1]{\lf{\BOX A}, \bBR{\BR{\Cx[2]}}}}{\Cx[1]{\bBR{\BR{\lf{\BOX A}, \Cx[2]}}}}
\vlinf{\lrn[2]\BOX}{}{\Cx[1]{\lf{\BOX A}, \BR{\Cx[2]}}}{\Cx[1]{\BR{\lf{\BOX A}, \Cx[2]}}}
\quad
\vlinf{\rrn[1]\DIA}{}{\Cx[1]{\rt{\DIA A}}}{\Cx{\rt A}}
\quad
\vlinf{\rrn[2]\DIA}{}{\Cx[1]{\rt{\DIA A}, \BR{\Cx[2]}}}{\Cx[1]{\BR{\rt{\DIA A}, \Cx[2]}}}
\]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Completeness}

%%%%%%%%%%%%%%%%%%%%k1%%%%%%%%%%%%%%%%%%
\begin{center}
	$\vlderivation{
		\vlin{\rrn\IMP}{}
		{\kax[1] \colon \rt{\BOX (A \IMP B) \IMP (\BOX A \IMP \BOX B)}}
		{\vlin {\rrn\IMP}{}
			{\bBR{\lf{\BOX(A \IMP B)}, \rt{\BOX A \IMP \BOX B}}}
			{\vlin {\rrn\BOX}{}
				{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX A}, \rt{\BOX B}}}}
				{\vlin {\lrn{mon}}{}
					{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\lf{\BOX A}, \bBR{\BR{\rt{B}}}}}}
					{\vlin {\lrn\BOX}{}
						{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\bBR{\lf{\BOX A},\BR{\rt{B}}}}}}
						{\vlin {\lrn{mon}}{}
							{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\bBR{\BR{\lf{A},\rt{B}}}}}}
							{\vlin {\lrn{mon}}{}
								{\bBR{\bBR{\lf{\BOX(A \IMP B)}, \bBR{\BR{\lf{A},\rt{B}}}}}}
								{\vlin{\lrn\BOX}{}
									{\bBR{\bBR{\bBR{\lf{\BOX(A \IMP B)}, \BR{\lf{A},\rt{B}}}}}}
									{\vliin{\lrn\IMP}{}
										{\bBR{\bBR{\bBR{\BR{\lf{A \IMP B}, \lf{A},\rt{B}}}}}}
										{\vlin{\rn{id}}{}
											{\bBR{\bBR{\bBR{\BR{\rt{A}, \lf{A},\rt{B}}}}}}
											{\vlhy{}}}
											{\vlin{\rn{id}}{}
												{\bBR{\bBR{\bBR{\BR{\lf{B}, \lf{A},\rt{B}}}}}}
												{\vlhy{}}}}}}}}}}}}
	$
\end{center}

%%%%%%%%%%%%%%%%%%%%k2%%%%%%%%%%%%%%%%%%
\begin{center}
	$\vlderivation {
		\vlin{\rrn\IMP}
		{}
		{ \kax[2]\colon \rt{\BOX (A \IMP B) \IMP (\DIA A \IMP \DIA B)}}
		{\vlin {\rrn\IMP}
			{}
			{\bBR{\lf{\BOX (A \IMP B)}, \rt{\DIA A \IMP \DIA B}}}
			{\vlin {\lrn\DIA}
				{}
				{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\lf{\DIA A}, \rt{\DIA B}}}}
				{\vlin{\rrn\DIA}
					{}
					{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\BR{\lf{A}}, \rt{\DIA B}}}}
					{\vlin {\lrn{mon}}
						{}
						{\bBR{\lf{\BOX (A \IMP B)}, \bBR{\BR{\lf{A}, \rt{B}}}}}
						{\vlin {\lrn\BOX}
							{}
							{\bBR{\bBR{\lf{\BOX (A \IMP B)}, \BR{\lf{A}, \rt{B}}}}}
							{\vliin{\lrn\IMP}
								{}
								{\bBR{\bBR{\BR{\lf{A \IMP B}, \lf{A}, \rt{B}}}}}
								{\vlin{\rn{id}}{}
									{\bBR{\bBR{\BR{\rt{A}, \lf{A}, \rt{B}}}}}
									{\vlhy{}}}
								{\vlin{\rn{id}}{}
									{\bBR{\bBR{\BR{\lf{B}, \lf{A}, \rt{B}}}}}
									{\vlhy{}}}}}}}}}
	}$
\end{center}
\bigskip

%%%%%%%%%%%%%%%%%%%%k3%%%%%%%%%%%%%%%%%%
\begin{center}
	
	$\vlderivation {
		\vlin{\rrn\IMP}
		{}
		{\kax[3] \colon \rt{\DIA (A \OR B) \IMP (\DIA A \OR \DIA B)}}
		{\vlin {\lrn\DIA}
			{}
			{\bBR{\lf{\DIA (A \OR B)}, \rt{\DIA A \OR \DIA B}}}
			{\vlin{\rrn\OR}{}
				{\bBR{\BR{\lf{A \OR B}}, \rt{\DIA A \OR \DIA B}}}
				{\vliin{\lrn\OR}{}
					{\bBR{\BR{\lf{A \OR B}}, \rt{\DIA A}, \rt{\DIA B}}}
					{\vlin{\rrn\DIA}{}
						{\bBR{\BR{\lf{A}}, \rt{\DIA A}, \rt{\DIA B}}}
						{\vlin{\rn{id}}{}
							{\bBR{\BR{\lf{A}, \rt{A}}, \rt{\DIA B}}}
							{\vlhy{}}}}
					{\vlin{\rrn\DIA}{}
						{\bBR{\BR{\lf{B}}, \rt{\DIA A}, \rt{\DIA B}}}
						{\vlin{\rn{id}}{}
							{\bBR{\BR{\lf{B}, \rt{B}}, \rt{\DIA A}}}
							{\vlhy{}}}}}}}
	}$
	
\end{center}

\bigskip

%%%%%%%%%%%%%%%%%%%%k4%%%%%%%%%%%%%%%%%%
\begin{center}
	
	$\vlderivation {
		\vlin{\rrn\IMP}
		{}
		{\kax[4] \colon \rt{(\DIA A \IMP \BOX B) \IMP \BOX(A \IMP B)}}
		{\vlin {\rrn\BOX}
			{}
			{\bBR{\lf{\DIA A \IMP \BOX B}, \rt{\BOX(A \IMP B)}}}
			{\vlin{\rrn\IMP}{}
				{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\BR{\rt{A \IMP B}}}}}
				{\vlin{\rn{F_\rn{1}}}{}
					{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\BR{\bBR{\lf{A}, \rt{B}}}}}}
					{\vlin{\lrn{mon}}{}
						{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\bBR{\BR{\lf{A}, \rt{B}}}}}}
						{\vlin{\lrn{mon}}{}
							{\bBR{\bBR{\lf{\DIA A \IMP \BOX B}, \bBR{\BR{\lf{A}, \rt{B}}}}}}
							{\vliin{\lrn\IMP}{}
								{\bBR{\bBR{\bBR{\lf{\DIA A \IMP \BOX B}, \BR{\lf{A}, \rt{B}}}}}}
								{\vlin{\rrn\DIA}{}
									{\bBR{\bBR{\bBR{\rt{\DIA A}, \BR{\lf{A}, \rt{B}}}}}}
									{\vlin{\rn{id}}{}
										{\bBR{\bBR{\bBR{\BR{\rt{A}, \lf{A}, \rt{B}}}}}}
										{\vlhy{}}}}
								{\vlin{\lrn\BOX}{}
									{\bBR{\bBR{\bBR{\lf{\BOX B}, \BR{\lf{A}, \rt{B}}}}}}
									{\vlin{\rn{id}}{}
										{\bBR{\bBR{\bBR{\BR{\lf{B}, \lf{A}, \rt{B}}}}}}
										{\vlhy{}}}}}}
						}
					}}}
	}$
	
\end{center}

\bigskip

%%%%%%%%%%%%%%%%%%%%k5%%%%%%%%%%%%%%%%%%
\begin{center}
	
	$\vlderivation {
		\vlin{\rrn\IMP}{}
		{\kax[5] \colon \rt{\DIA \BOT \IMP \BOT}}
		{\vlin {\lrn\DIA}{}
			{\bBR{\lf{\DIA \BOT}, \rt{\BOT}}}
			{\vlin {\lrn{\BOT}}{}
				{\bBR{\BR{\lf{\BOT}}, \rt{\BOT}}}
				{\vlhy {}}}}
	}$
	
\end{center}

\subsection{Cut admissibility}

In this section we are going to prove the admissibility of cut for the system $\rn{NIK}$.

\begin{theorem}
	\label{thm:cut-adm}
	The $\rn{cut}$ rule is admissible for $\rn{NIK}$.
	\end{theorem}

\begin{lemma}
	\label{lem:reduction}
	Given a derivation of shape
	$$
	\vlderivation{
		\vliiin{\labrn{cut}}{}{\Cx{\Gamma_{1}}}{
			\vlhtr{\DD_1}{\Cx{\Gamma_{1}, \rt{C}}}}{
			\vlhy{}}{
			\vlhtr{\DD_2}{\Cx{\Gamma_{1}, \lf{C}}}}}
	$$
	where $\DD_1$ and $\DD_2$ are both cut-free, there is a cut-free
	derivation of $\Cx{\Gamma_{1}}$
\end{lemma}

\begin{proof}
	
	We perform a case analysis on the last rule used in $\DD_1$ above the $\rn{cut}$ and whether it applies to the cut-formula or not.
	%
	In case it does not, we are in a \emph{commutative} case; in case it does, we have to perform a similar analysis on $\DD_2$ to end up in a \emph{key} case.

\newpage
\textbf{Key cases}

\begin{itemize}
\item $C=A \AND B$:

$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\Gamma_{1}}}
	{\vliin{\rrn\AND}{}
		{\Cx{\Gamma_{1}, \rt{A \AND B}}}
		{\vlhtr{\DD_1}{\Cx{\Gamma_{1}, \rt{A}}}}
		{\vlhtr{\DD_2}{\Cx{\Gamma_{1}, \rt{B}}}}}
	{\vlin{\lrn\AND}{}
		{\Cx{\Gamma_{1}, \lf{A \AND B}}}
		{\vlhtr{\DD_3}{\Cx{\Gamma_{1}, \lf{A}, \lf{B}}}}}
	}$
	$\reducesto$
$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\Gamma_{1}}}
	{\vlhtr{\DD_1}{\Cx{\Gamma_{1}, \rt{A}}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\Gamma_{1}, \lf{A}}}
		{\vlhtr{\DD_2^{w}}{\Cx{\Gamma_{1}, \lf{A}, \rt{B}}}}
		{\vlhtr{\DD_3}{\Cx{\Gamma_{1}, \lf{A}, \lf{B}}}}}
	}$

\item $C= A \OR B$:

$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\Gamma_{1}}}
	{\vlin{\rrn\OR}{}
		{\Cx{\Gamma_{1}, \rt{A \OR B}}}
		{\vlhtr{\DD_1}{\Cx{\Gamma_{1}, \rt{A},\rt{B}}}}}
	{\vliin{\lrn\OR}{}
		{}
		{}
		{}}
	}$
\item $C=A \IMP B$:

$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\Gamma_{1}}}
	{\vlin{\rrn\IMP}{}
		{\Cx{\Gamma_{1}, \rt{A \IMP B}}}
		{\vlhtr{\DD_1}{\Cx{\Gamma_{1}, \bBR{\lf{A}, \rt{B}}}}}}
	{\vliin{\lrn\IMP}{}
		{\Cx{\Gamma_{1}, \lf{A \IMP B}}}
		{\vlhtr{\DD_2}{\Cx{\Gamma_{1}, \rt{A}}}}
		{\vlhtr{\DD_3}{\Cx{\Gamma_{1}, \lf{B}}}}}}$
	$\reducesto$
$\vlderivation{
	\vliin{}{}
	{\Cx{\Gamma_{1}}}
	{\vlhtr{\DD_2}{\Cx{\Gamma_{1}, \rt{A}}}}
	{\vliin{\rn{cut}}{}
		{\Cx{\Gamma_{1}, \lf{A}}}
		{\vlin{\rn{refl}}{}{\Cx{\Gamma_{1}, \lf{A}, \rt{B}}}{\vlhtr{\DD_1}{\Cx{\Gamma_{1}, \bBR{\lf{A}, \rt{B}}}}}}
		{\vlhtr{\DD_3^{w}}{\Cx{\Gamma_{1}, \lf{A}, \lf{B}}}}}
	}$
	
\item $C=\BOX A$:


$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Gamma_{1}}}}
	{\vlin{\rrn\BOX}{}
		{\Cx{\BR{\Gamma_{1}}, \rt{\BOX A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Gamma_{1}}, \bBR{\BR{\rt{A}}}}}}}
	{\vlin{\lrn\BOX}{}
		{\Cx{\BR{\Gamma_{1}}, \lf{\BOX A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Gamma_{1}, \lf{A}}}}}}
	}$
	$\reducesto$
$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Gamma_{1}}}}
	{\vlin{\rn{refl}}{}
		{\Cx{\BR{\Gamma_{1}}, \BR{\rt{A}}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Gamma_{1}}, \bBR{\BR{\rt{A}}}}}}}
	{\vlin{}{}{\Cx{\BR{\Gamma_{1}}, \BR{\lf{A}}}}{}}}$

\item $C=\DIA A$:

$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Gamma_{1}}}}
	{\vlin{\rrn\DIA}{}
		{\Cx{\BR{\Gamma_{1}}, \rt{\DIA A}}}
		{\vlhtr{\DD_1}{\Cx{\BR{\Gamma_{1}, \rt{A}}}}}}
	{\vlin{\lrn\DIA}{}
		{\Cx{\BR{\Gamma_{1}}, \lf{\DIA A}}}
		{\vlhtr{\DD_2}{\Cx{\BR{\Gamma_{1}}, \BR{\lf{A}}}}}}
	}$
	$\reducesto$
$\vlderivation{
	\vliin{\rn{cut}}{}
	{\Cx{\BR{\Gamma_{1}}}}
	{\vlin{}{}{}{}}
	{\vlin{}{}{}{}}
	}$
\end{itemize}
\end{proof}

%% Bibliography
%\bibliographystyle{plain}
%\bibliography{references}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}